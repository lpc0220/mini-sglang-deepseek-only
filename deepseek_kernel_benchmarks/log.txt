======================================================================
DeepSeek-R1-NVFP4-v2 Kernel Benchmarks
======================================================================
Kernels to run: 23
Batch sizes: 1,2,4,8,16,32,64,128
Sequence lengths: 128,256,512,1024,2048
Output directory: ../results/

NOTE: Each kernel runs in a separate subprocess for isolation.
      CUDA crashes in one kernel will NOT affect other kernels.
======================================================================

======================================================================
Running: rmsnorm (Norm, Memory)
======================================================================
============================================================
Benchmark: rmsnorm (Kernel #1)
============================================================

=== Decode Phase ===
  B=1: 0.0019 ms, 15.0 GB/s, 0.2% peak
  B=2: 0.0019 ms, 30.0 GB/s, 0.4% peak
  B=4: 0.0019 ms, 59.8 GB/s, 0.7% peak
  B=8: 0.0019 ms, 119.4 GB/s, 1.5% peak
  B=16: 0.0020 ms, 234.8 GB/s, 2.9% peak
  B=32: 0.0020 ms, 464.9 GB/s, 5.8% peak
  B=64: 0.0020 ms, 919.0 GB/s, 11.5% peak
  B=128: 0.0021 ms, 1775.6 GB/s, 22.2% peak

=== Prefill Phase ===
  B=1, S=128: 0.0021 ms, 1775.4 GB/s, 22.2% peak
  B=1, S=256: 0.0027 ms, 2763.9 GB/s, 34.5% peak
  B=1, S=512: 0.0046 ms, 3178.2 GB/s, 39.7% peak
  B=1, S=1024: 0.0081 ms, 3627.8 GB/s, 45.3% peak
  B=1, S=2048: 0.0150 ms, 3913.3 GB/s, 48.9% peak
  B=2, S=128: 0.0027 ms, 2759.1 GB/s, 34.5% peak
  B=2, S=256: 0.0046 ms, 3177.9 GB/s, 39.7% peak
  B=2, S=512: 0.0081 ms, 3627.5 GB/s, 45.3% peak
  B=2, S=1024: 0.0150 ms, 3912.6 GB/s, 48.9% peak
  B=2, S=2048: 0.0359 ms, 3269.3 GB/s, 40.9% peak
  B=4, S=128: 0.0046 ms, 3162.1 GB/s, 39.5% peak
  B=4, S=256: 0.0081 ms, 3623.1 GB/s, 45.3% peak
  B=4, S=512: 0.0151 ms, 3894.3 GB/s, 48.7% peak
  B=4, S=1024: 0.0364 ms, 3226.5 GB/s, 40.3% peak
  B=4, S=2048: 0.0703 ms, 3340.5 GB/s, 41.8% peak
  B=8, S=128: 0.0081 ms, 3623.6 GB/s, 45.3% peak
  B=8, S=256: 0.0151 ms, 3887.9 GB/s, 48.6% peak
  B=8, S=512: 0.0366 ms, 3211.7 GB/s, 40.1% peak
  B=8, S=1024: 0.0705 ms, 3332.1 GB/s, 41.7% peak
  B=8, S=2048: 0.1374 ms, 3418.1 GB/s, 42.7% peak
Saved ../results/rmsnorm.csv

[OK] rmsnorm completed successfully

======================================================================
Running: fused_add_rmsnorm (Norm, Memory)
======================================================================
============================================================
Benchmark: fused_add_rmsnorm (Kernel #2)
============================================================

=== Decode Phase ===
  B=1: 0.0024 ms, 24.3 GB/s, 0.3% peak
  B=2: 0.0024 ms, 48.6 GB/s, 0.6% peak
  B=4: 0.0024 ms, 97.3 GB/s, 1.2% peak
  B=8: 0.0024 ms, 187.5 GB/s, 2.3% peak
  B=16: 0.0025 ms, 372.0 GB/s, 4.7% peak
  B=32: 0.0024 ms, 751.5 GB/s, 9.4% peak
  B=64: 0.0025 ms, 1490.5 GB/s, 18.6% peak
  B=128: 0.0026 ms, 2872.7 GB/s, 35.9% peak

=== Prefill Phase ===
  B=1, S=128: 0.0026 ms, 2872.9 GB/s, 35.9% peak
  B=1, S=256: 0.0045 ms, 3271.2 GB/s, 40.9% peak
  B=1, S=512: 0.0081 ms, 3634.5 GB/s, 45.4% peak
  B=1, S=1024: 0.0143 ms, 4116.2 GB/s, 51.5% peak
  B=1, S=2048: 0.0272 ms, 4318.6 GB/s, 54.0% peak
  B=2, S=128: 0.0045 ms, 3234.2 GB/s, 40.4% peak
  B=2, S=256: 0.0081 ms, 3636.5 GB/s, 45.5% peak
  B=2, S=512: 0.0142 ms, 4132.7 GB/s, 51.7% peak
  B=2, S=1024: 0.0273 ms, 4303.6 GB/s, 53.8% peak
  B=2, S=2048: 0.0674 ms, 3485.2 GB/s, 43.6% peak
  B=4, S=128: 0.0081 ms, 3636.0 GB/s, 45.5% peak
  B=4, S=256: 0.0142 ms, 4136.6 GB/s, 51.7% peak
  B=4, S=512: 0.0274 ms, 4285.0 GB/s, 53.6% peak
  B=4, S=1024: 0.0673 ms, 3491.9 GB/s, 43.6% peak
  B=4, S=2048: 0.1307 ms, 3592.9 GB/s, 44.9% peak
  B=8, S=128: 0.0143 ms, 4111.4 GB/s, 51.4% peak
  B=8, S=256: 0.0274 ms, 4289.2 GB/s, 53.6% peak
  B=8, S=512: 0.0677 ms, 3470.0 GB/s, 43.4% peak
  B=8, S=1024: 0.1316 ms, 3568.9 GB/s, 44.6% peak
  B=8, S=2048: 0.2594 ms, 3621.3 GB/s, 45.3% peak
Saved ../results/fused_add_rmsnorm.csv

[OK] fused_add_rmsnorm completed successfully

======================================================================
Running: cutlass_scaled_fp4_mm (GEMM, Compute)
======================================================================
============================================================
Benchmark: cutlass_scaled_fp4_mm (Kernel #3)
============================================================

=== Decode Phase ===
  q_b_proj B=1: 0.0063 ms, 11943.8 GFLOPS, 0.13% peak
  kv_b_proj B=1: 0.0051 ms, 6628.8 GFLOPS, 0.07% peak
  o_proj B=1: 0.0233 ms, 10089.1 GFLOPS, 0.11% peak
  q_b_proj B=2: 0.0064 ms, 23684.9 GFLOPS, 0.26% peak
  kv_b_proj B=2: 0.0051 ms, 13287.5 GFLOPS, 0.15% peak
  o_proj B=2: 0.0234 ms, 20046.4 GFLOPS, 0.22% peak
  q_b_proj B=4: 0.0063 ms, 48059.1 GFLOPS, 0.53% peak
  kv_b_proj B=4: 0.0051 ms, 26331.5 GFLOPS, 0.29% peak
  o_proj B=4: 0.0233 ms, 40327.0 GFLOPS, 0.45% peak
  q_b_proj B=8: 0.0063 ms, 96042.8 GFLOPS, 1.07% peak
  kv_b_proj B=8: 0.0050 ms, 53329.2 GFLOPS, 0.59% peak
  o_proj B=8: 0.0233 ms, 80760.5 GFLOPS, 0.90% peak
  q_b_proj B=16: 0.0063 ms, 192295.0 GFLOPS, 2.14% peak
  kv_b_proj B=16: 0.0050 ms, 108173.5 GFLOPS, 1.20% peak
  o_proj B=16: 0.0233 ms, 161579.1 GFLOPS, 1.80% peak
  q_b_proj B=32: 0.0063 ms, 384688.5 GFLOPS, 4.27% peak
  kv_b_proj B=32: 0.0050 ms, 215604.0 GFLOPS, 2.40% peak
  o_proj B=32: 0.0233 ms, 322883.8 GFLOPS, 3.59% peak
  q_b_proj B=64: 0.0064 ms, 758436.3 GFLOPS, 8.43% peak
  kv_b_proj B=64: 0.0050 ms, 425558.2 GFLOPS, 4.73% peak
  o_proj B=64: 0.0234 ms, 642980.6 GFLOPS, 7.14% peak
  q_b_proj B=128: 0.0068 ms, 1420091.9 GFLOPS, 15.78% peak
  kv_b_proj B=128: 0.0054 ms, 794653.0 GFLOPS, 8.83% peak
  o_proj B=128: 0.0240 ms, 1254783.4 GFLOPS, 13.94% peak

=== Prefill Phase ===
  q_b_proj B=1, S=128: 0.0068 ms, 1420780.3 GFLOPS, 15.79% peak
  kv_b_proj B=1, S=128: 0.0054 ms, 794067.6 GFLOPS, 8.82% peak
  o_proj B=1, S=128: 0.0240 ms, 1253475.3 GFLOPS, 13.93% peak
  q_b_proj B=1, S=256: 0.0092 ms, 2103865.3 GFLOPS, 23.38% peak
  kv_b_proj B=1, S=256: 0.0070 ms, 1220358.1 GFLOPS, 13.56% peak
  o_proj B=1, S=256: 0.0227 ms, 2648918.7 GFLOPS, 29.43% peak
  q_b_proj B=1, S=512: 0.0124 ms, 3118230.2 GFLOPS, 34.65% peak
  kv_b_proj B=1, S=512: 0.0102 ms, 1686385.2 GFLOPS, 18.74% peak
  o_proj B=1, S=512: 0.0241 ms, 4997695.3 GFLOPS, 55.53% peak
  q_b_proj B=1, S=1024: 0.0200 ms, 3869244.8 GFLOPS, 42.99% peak
  kv_b_proj B=1, S=1024: 0.0150 ms, 2293522.7 GFLOPS, 25.48% peak
  o_proj B=1, S=1024: 0.0510 ms, 4712301.4 GFLOPS, 52.36% peak
  q_b_proj B=1, S=2048: 0.0401 ms, 3856387.1 GFLOPS, 42.85% peak
  kv_b_proj B=1, S=2048: 0.0288 ms, 2385081.2 GFLOPS, 26.50% peak
  o_proj B=1, S=2048: 0.0940 ms, 5115622.1 GFLOPS, 56.84% peak
  q_b_proj B=2, S=128: 0.0091 ms, 2113988.5 GFLOPS, 23.49% peak
  kv_b_proj B=2, S=128: 0.0070 ms, 1228768.4 GFLOPS, 13.65% peak
  o_proj B=2, S=128: 0.0227 ms, 2651485.8 GFLOPS, 29.46% peak
  q_b_proj B=2, S=256: 0.0124 ms, 3111900.3 GFLOPS, 34.58% peak
  kv_b_proj B=2, S=256: 0.0102 ms, 1688808.6 GFLOPS, 18.76% peak
  o_proj B=2, S=256: 0.0253 ms, 4761409.9 GFLOPS, 52.90% peak
  q_b_proj B=2, S=512: 0.0199 ms, 3884689.7 GFLOPS, 43.16% peak
  kv_b_proj B=2, S=512: 0.0149 ms, 2305135.4 GFLOPS, 25.61% peak
  o_proj B=2, S=512: 0.0494 ms, 4864353.8 GFLOPS, 54.05% peak
  q_b_proj B=2, S=1024: 0.0400 ms, 3861305.6 GFLOPS, 42.90% peak
  kv_b_proj B=2, S=1024: 0.0285 ms, 2415396.5 GFLOPS, 26.84% peak
  o_proj B=2, S=1024: 0.0922 ms, 5217806.6 GFLOPS, 57.98% peak
  q_b_proj B=2, S=2048: 0.0751 ms, 4119114.6 GFLOPS, 45.77% peak
  kv_b_proj B=2, S=2048: 0.0529 ms, 2598837.1 GFLOPS, 28.88% peak
  o_proj B=2, S=2048: 0.1829 ms, 5260592.4 GFLOPS, 58.45% peak
  q_b_proj B=4, S=128: 0.0124 ms, 3108292.3 GFLOPS, 34.54% peak
  kv_b_proj B=4, S=128: 0.0102 ms, 1688729.4 GFLOPS, 18.76% peak
  o_proj B=4, S=128: 0.0244 ms, 4932264.5 GFLOPS, 54.80% peak
  q_b_proj B=4, S=256: 0.0200 ms, 3868182.7 GFLOPS, 42.98% peak
  kv_b_proj B=4, S=256: 0.0154 ms, 2236146.8 GFLOPS, 24.85% peak
  o_proj B=4, S=256: 0.0504 ms, 4774793.3 GFLOPS, 53.05% peak
  q_b_proj B=4, S=512: 0.0403 ms, 3840704.2 GFLOPS, 42.67% peak
  kv_b_proj B=4, S=512: 0.0284 ms, 2420556.5 GFLOPS, 26.90% peak
  o_proj B=4, S=512: 0.0946 ms, 5086995.3 GFLOPS, 56.52% peak
  q_b_proj B=4, S=1024: 0.0744 ms, 4157378.9 GFLOPS, 46.19% peak
  kv_b_proj B=4, S=1024: 0.0538 ms, 2552852.0 GFLOPS, 28.37% peak
  o_proj B=4, S=1024: 0.1827 ms, 5265011.5 GFLOPS, 58.50% peak
  q_b_proj B=4, S=2048: 0.1450 ms, 4265224.1 GFLOPS, 47.39% peak
  kv_b_proj B=4, S=2048: 0.1014 ms, 2710830.0 GFLOPS, 30.12% peak
  o_proj B=4, S=2048: 0.3605 ms, 5336880.6 GFLOPS, 59.30% peak
  q_b_proj B=8, S=128: 0.0204 ms, 3789339.2 GFLOPS, 42.10% peak
  kv_b_proj B=8, S=128: 0.0153 ms, 2243040.8 GFLOPS, 24.92% peak
  o_proj B=8, S=128: 0.0495 ms, 4861087.6 GFLOPS, 54.01% peak
  q_b_proj B=8, S=256: 0.0403 ms, 3831944.6 GFLOPS, 42.58% peak
  kv_b_proj B=8, S=256: 0.0283 ms, 2426848.7 GFLOPS, 26.96% peak
  o_proj B=8, S=256: 0.0928 ms, 5182647.0 GFLOPS, 57.58% peak
  q_b_proj B=8, S=512: 0.0748 ms, 4135154.5 GFLOPS, 45.95% peak
  kv_b_proj B=8, S=512: 0.0531 ms, 2587577.8 GFLOPS, 28.75% peak
  o_proj B=8, S=512: 0.1841 ms, 5224549.5 GFLOPS, 58.05% peak
  q_b_proj B=8, S=1024: 0.1460 ms, 4236107.8 GFLOPS, 47.07% peak
  kv_b_proj B=8, S=1024: 0.1020 ms, 2695152.5 GFLOPS, 29.95% peak
  o_proj B=8, S=1024: 0.3621 ms, 5314396.9 GFLOPS, 59.05% peak
  q_b_proj B=8, S=2048: 0.2949 ms, 4194170.8 GFLOPS, 46.60% peak
  kv_b_proj B=8, S=2048: 0.2034 ms, 2703140.0 GFLOPS, 30.03% peak
  o_proj B=8, S=2048: 0.7197 ms, 5346763.7 GFLOPS, 59.41% peak
Saved ../results/cutlass_scaled_fp4_mm.csv

[OK] cutlass_scaled_fp4_mm completed successfully

======================================================================
Running: dsv3_fused_a_gemm (GEMM, Compute)
======================================================================
============================================================
Benchmark: dsv3_fused_a_gemm (Kernel #4)
============================================================

=== Decode Phase (B<=16, low-latency path) ===
  B=1: 0.0051 ms, 5946.8 GFLOPS, 0.26% peak
  B=2: 0.0051 ms, 11908.7 GFLOPS, 0.53% peak
  B=4: 0.0051 ms, 23704.2 GFLOPS, 1.05% peak
  B=8: 0.0052 ms, 46803.8 GFLOPS, 2.08% peak
  B=16: 0.0058 ms, 83637.8 GFLOPS, 3.72% peak
Saved ../results/dsv3_fused_a_gemm.csv

[OK] dsv3_fused_a_gemm completed successfully

======================================================================
Running: dsv3_router_gemm (GEMM, Compute)
======================================================================
============================================================
Benchmark: dsv3_router_gemm (Kernel #5)
============================================================

=== Decode Phase ===
  B=1: 0.0020 ms, 1836.5 GFLOPS, 0.08% peak
  B=2: 0.0022 ms, 3334.8 GFLOPS, 0.15% peak
  B=4: 0.0027 ms, 5463.2 GFLOPS, 0.24% peak
  B=8: 0.0036 ms, 8167.2 GFLOPS, 0.36% peak
  B=16: 0.0071 ms, 8233.4 GFLOPS, 0.37% peak
  Skipping B=32: kernel limited to num_tokens <= 16
  Skipping B=64: kernel limited to num_tokens <= 16
  Skipping B=128: kernel limited to num_tokens <= 16

=== Prefill Phase (skipped - kernel limited to 16 tokens) ===
Saved ../results/dsv3_router_gemm.csv

[OK] dsv3_router_gemm completed successfully

======================================================================
Running: bmm_fp8 (BMM, Compute)
======================================================================
============================================================
Benchmark: bmm_fp8 (Kernel #6)
============================================================

=== Decode Phase: q_nope * w_kc ===
  B=1: 0.0055 ms, 3056.2 GFLOPS, 0.07% peak
  B=2: 0.0055 ms, 6105.4 GFLOPS, 0.14% peak
  B=4: 0.0055 ms, 12196.9 GFLOPS, 0.27% peak
  B=8: 0.0055 ms, 24402.1 GFLOPS, 0.54% peak
  B=16: 0.0056 ms, 47686.4 GFLOPS, 1.06% peak
  B=32: 0.0058 ms, 93365.4 GFLOPS, 2.07% peak
  B=64: 0.0061 ms, 175546.5 GFLOPS, 3.90% peak
  B=128: 0.0070 ms, 308770.8 GFLOPS, 6.86% peak

=== Decode Phase: attn * w_vc ===
  B=1: 0.0027 ms, 6113.6 GFLOPS, 0.14% peak
  B=2: 0.0027 ms, 12229.7 GFLOPS, 0.27% peak
  B=4: 0.0027 ms, 24528.1 GFLOPS, 0.55% peak
  B=8: 0.0027 ms, 48808.4 GFLOPS, 1.08% peak
  B=16: 0.0031 ms, 85838.4 GFLOPS, 1.91% peak
  B=32: 0.0032 ms, 168655.5 GFLOPS, 3.75% peak
  B=64: 0.0034 ms, 320516.2 GFLOPS, 7.12% peak
  B=128: 0.0037 ms, 575187.4 GFLOPS, 12.78% peak
Saved ../results/bmm_fp8.csv

[OK] bmm_fp8 completed successfully

======================================================================
Running: cutlass_mla_decode (Attention, Mixed)
======================================================================
============================================================
Benchmark: cutlass_mla_decode (Kernel #7)
============================================================

=== Decode Phase (MLA Attention) ===
  B=1, seq_len=128: 0.0184 ms, 16.1 GB/s, memory
  B=1, seq_len=256: 0.0307 ms, 14.4 GB/s, memory
  B=1, seq_len=512: 0.0307 ms, 24.0 GB/s, memory
  B=1, seq_len=1024: 0.0317 ms, 41.9 GB/s, memory
  Skipping B=1, seq_len=2048: B*seq_len=2048 > 1024 (crash risk)
  B=2, seq_len=128: 0.0187 ms, 31.6 GB/s, memory
  B=2, seq_len=256: 0.0309 ms, 28.7 GB/s, memory
  B=2, seq_len=512: 0.0308 ms, 47.9 GB/s, memory
  Skipping B=2, seq_len=1024: B*seq_len=2048 > 1024 (crash risk)
  Skipping B=2, seq_len=2048: B*seq_len=4096 > 1024 (crash risk)
  B=4, seq_len=128: 0.0187 ms, 63.0 GB/s, memory
  B=4, seq_len=256: 0.0316 ms, 56.1 GB/s, memory
  Skipping B=4, seq_len=512: B*seq_len=2048 > 1024 (crash risk)
  Skipping B=4, seq_len=1024: B*seq_len=4096 > 1024 (crash risk)
  Skipping B=4, seq_len=2048: B*seq_len=8192 > 1024 (crash risk)
  B=8, seq_len=128: 0.0187 ms, 126.1 GB/s, memory
  Skipping B=8, seq_len=256: B*seq_len=2048 > 1024 (crash risk)
  Skipping B=8, seq_len=512: B*seq_len=4096 > 1024 (crash risk)
  Skipping B=8, seq_len=1024: B*seq_len=8192 > 1024 (crash risk)
  Skipping B=8, seq_len=2048: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=16, seq_len=128: B*seq_len=2048 > 1024 (crash risk)
  Skipping B=16, seq_len=256: B*seq_len=4096 > 1024 (crash risk)
  Skipping B=16, seq_len=512: B*seq_len=8192 > 1024 (crash risk)
  Skipping B=16, seq_len=1024: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=16, seq_len=2048: B*seq_len=32768 > 1024 (crash risk)
  Skipping B=32, seq_len=128: B*seq_len=4096 > 1024 (crash risk)
  Skipping B=32, seq_len=256: B*seq_len=8192 > 1024 (crash risk)
  Skipping B=32, seq_len=512: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=32, seq_len=1024: B*seq_len=32768 > 1024 (crash risk)
  Skipping B=32, seq_len=2048: B*seq_len=65536 > 1024 (crash risk)
  Skipping B=64, seq_len=128: B*seq_len=8192 > 1024 (crash risk)
  Skipping B=64, seq_len=256: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=64, seq_len=512: B*seq_len=32768 > 1024 (crash risk)
  Skipping B=64, seq_len=1024: B*seq_len=65536 > 1024 (crash risk)
  Skipping B=64, seq_len=2048: B*seq_len=131072 > 1024 (crash risk)
  Skipping B=128, seq_len=128: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=128, seq_len=256: B*seq_len=32768 > 1024 (crash risk)
  Skipping B=128, seq_len=512: B*seq_len=65536 > 1024 (crash risk)
  Skipping B=128, seq_len=1024: B*seq_len=131072 > 1024 (crash risk)
  Skipping B=128, seq_len=2048: B*seq_len=262144 > 1024 (crash risk)
Saved ../results/cutlass_mla_decode.csv

[OK] cutlass_mla_decode completed successfully

======================================================================
Running: trtllm_batch_decode_with_kv_cache_mla (Attention, Mixed)
======================================================================
============================================================
Benchmark: trtllm_batch_decode_with_kv_cache_mla (Kernel #8)
============================================================

=== Decode Phase (TRT-LLM MLA Attention) ===

  Page size: 32
    B=1, seq_len=128: 0.0055 ms, 53.2 GB/s, memory
    B=1, seq_len=256: 0.0055 ms, 80.7 GB/s, memory
    B=1, seq_len=512: 0.0074 ms, 99.6 GB/s, memory
    B=1, seq_len=1024: 0.0098 ms, 134.8 GB/s, memory
    B=1, seq_len=2048: 0.0114 ms, 220.4 GB/s, memory
    B=2, seq_len=128: 0.0059 ms, 99.5 GB/s, memory
    B=2, seq_len=256: 0.0060 ms, 147.3 GB/s, memory
    B=2, seq_len=512: 0.0081 ms, 182.1 GB/s, memory
    B=2, seq_len=1024: 0.0102 ms, 259.3 GB/s, memory
    B=2, seq_len=2048: 0.0127 ms, 396.1 GB/s, memory
    B=4, seq_len=128: 0.0068 ms, 172.3 GB/s, memory
    B=4, seq_len=256: 0.0068 ms, 259.2 GB/s, memory
    B=4, seq_len=512: 0.0090 ms, 327.0 GB/s, memory
    B=4, seq_len=1024: 0.0115 ms, 460.2 GB/s, memory
    B=4, seq_len=2048: 0.0163 ms, 614.5 GB/s, memory
    B=8, seq_len=128: 0.0076 ms, 311.2 GB/s, memory
    B=8, seq_len=256: 0.0076 ms, 467.5 GB/s, memory
    B=8, seq_len=512: 0.0104 ms, 569.0 GB/s, memory
    B=8, seq_len=1024: 0.0155 ms, 686.8 GB/s, memory
    B=8, seq_len=2048: 0.0232 ms, 863.4 GB/s, memory
    B=16, seq_len=128: 0.0093 ms, 508.7 GB/s, memory
    B=16, seq_len=256: 0.0093 ms, 763.1 GB/s, memory
    B=16, seq_len=512: 0.0131 ms, 897.8 GB/s, memory
    B=16, seq_len=1024: 0.0201 ms, 1055.4 GB/s, memory
    B=16, seq_len=2048: 0.0158 ms, 2532.0 GB/s, memory
    B=32, seq_len=128: 0.0074 ms, 1269.1 GB/s, memory
    B=32, seq_len=256: 0.0088 ms, 1610.0 GB/s, memory
    B=32, seq_len=512: 0.0142 ms, 1664.0 GB/s, memory
    B=32, seq_len=1024: 0.0171 ms, 2487.9 GB/s, memory
    B=32, seq_len=2048: 0.0233 ms, 3435.8 GB/s, memory
    B=64, seq_len=128: 0.0081 ms, 2322.4 GB/s, memory
    B=64, seq_len=256: 0.0100 ms, 2845.1 GB/s, memory
    B=64, seq_len=512: 0.0129 ms, 3667.6 GB/s, memory
    B=64, seq_len=1024: 0.0195 ms, 4364.2 GB/s, memory
    B=64, seq_len=2048: 0.0436 ms, 3675.5 GB/s, memory
    B=128, seq_len=128: 0.0127 ms, 2979.3 GB/s, memory
    B=128, seq_len=256: 0.0172 ms, 3291.4 GB/s, memory
    B=128, seq_len=512: 0.0251 ms, 3756.0 GB/s, memory
    B=128, seq_len=1024: 0.0463 ms, 3670.0 GB/s, memory
    B=128, seq_len=2048: 0.0858 ms, 3741.0 GB/s, memory

  Page size: 64
    B=1, seq_len=128: 0.0056 ms, 52.9 GB/s, memory
    B=1, seq_len=256: 0.0055 ms, 81.1 GB/s, memory
    B=1, seq_len=512: 0.0074 ms, 99.1 GB/s, memory
    B=1, seq_len=1024: 0.0098 ms, 135.1 GB/s, memory
    B=1, seq_len=2048: 0.0110 ms, 227.2 GB/s, memory
    B=2, seq_len=128: 0.0058 ms, 102.3 GB/s, memory
    B=2, seq_len=256: 0.0056 ms, 157.5 GB/s, memory
    B=2, seq_len=512: 0.0076 ms, 193.7 GB/s, memory
    B=2, seq_len=1024: 0.0097 ms, 274.0 GB/s, memory
    B=2, seq_len=2048: 0.0114 ms, 439.9 GB/s, memory
    B=4, seq_len=128: 0.0063 ms, 185.9 GB/s, memory
    B=4, seq_len=256: 0.0063 ms, 280.4 GB/s, memory
    B=4, seq_len=512: 0.0083 ms, 355.9 GB/s, memory
    B=4, seq_len=1024: 0.0109 ms, 487.7 GB/s, memory
    B=4, seq_len=2048: 0.0144 ms, 698.4 GB/s, memory
    B=8, seq_len=128: 0.0070 ms, 336.9 GB/s, memory
    B=8, seq_len=256: 0.0068 ms, 517.7 GB/s, memory
    B=8, seq_len=512: 0.0094 ms, 629.2 GB/s, memory
    B=8, seq_len=1024: 0.0135 ms, 783.6 GB/s, memory
    B=8, seq_len=2048: 0.0204 ms, 983.5 GB/s, memory
    B=16, seq_len=128: 0.0081 ms, 582.7 GB/s, memory
    B=16, seq_len=256: 0.0081 ms, 875.2 GB/s, memory
    B=16, seq_len=512: 0.0116 ms, 1015.2 GB/s, memory
    B=16, seq_len=1024: 0.0186 ms, 1139.0 GB/s, memory
    B=16, seq_len=2048: 0.0155 ms, 2595.1 GB/s, memory
    B=32, seq_len=128: 0.0072 ms, 1312.8 GB/s, memory
    B=32, seq_len=256: 0.0084 ms, 1680.7 GB/s, memory
    B=32, seq_len=512: 0.0139 ms, 1691.4 GB/s, memory
    B=32, seq_len=1024: 0.0169 ms, 2513.4 GB/s, memory
    B=32, seq_len=2048: 0.0237 ms, 3390.6 GB/s, memory
    B=64, seq_len=128: 0.0081 ms, 2322.1 GB/s, memory
    B=64, seq_len=256: 0.0098 ms, 2888.3 GB/s, memory
    B=64, seq_len=512: 0.0126 ms, 3745.1 GB/s, memory
    B=64, seq_len=1024: 0.0189 ms, 4485.0 GB/s, memory
    B=64, seq_len=2048: 0.0436 ms, 3678.9 GB/s, memory
    B=128, seq_len=128: 0.0125 ms, 3021.0 GB/s, memory
    B=128, seq_len=256: 0.0170 ms, 3336.4 GB/s, memory
    B=128, seq_len=512: 0.0248 ms, 3808.1 GB/s, memory
    B=128, seq_len=1024: 0.0472 ms, 3601.4 GB/s, memory
    B=128, seq_len=2048: 0.0855 ms, 3753.2 GB/s, memory
Saved ../results/trtllm_batch_decode_with_kv_cache_mla.csv

[OK] trtllm_batch_decode_with_kv_cache_mla completed successfully

======================================================================
Running: trtllm_ragged_attention_deepseek (Attention, Mixed)
======================================================================
============================================================
Benchmark: trtllm_ragged_attention_deepseek (Kernel #9)
============================================================

=== Prefill Phase (TRT-LLM Ragged Attention) ===
  B=1, S=128: 0.0072 ms, 740.0 GFLOPS, memory
  B=1, S=256: 0.0103 ms, 3304.1 GFLOPS, memory
  B=1, S=512: 0.0183 ms, 4819.0 GFLOPS, memory
  B=1, S=1024: 0.0352 ms, 7725.6 GFLOPS, memory
  B=1, S=2048: 0.0836 ms, 11261.9 GFLOPS, memory
  B=2, S=128: 0.0118 ms, 1149.2 GFLOPS, memory
  B=2, S=256: 0.0176 ms, 4292.6 GFLOPS, memory
  B=2, S=512: 0.0365 ms, 5161.0 GFLOPS, memory
  B=2, S=1024: 0.0900 ms, 9199.3 GFLOPS, memory
  B=2, S=2048: 0.2540 ms, 13644.9 GFLOPS, memory
  B=4, S=128: 0.0195 ms, 1606.1 GFLOPS, memory
  B=4, S=256: 0.0347 ms, 3431.5 GFLOPS, memory
  B=4, S=512: 0.0752 ms, 6179.9 GFLOPS, memory
  B=4, S=1024: 0.1611 ms, 9588.2 GFLOPS, memory
  B=4, S=2048: 0.4987 ms, 13437.1 GFLOPS, memory
  B=8, S=128: 0.0358 ms, 1778.1 GFLOPS, memory
  B=8, S=256: 0.0599 ms, 3691.6 GFLOPS, memory
  B=8, S=512: 0.1369 ms, 6003.6 GFLOPS, memory
  B=8, S=1024: 0.3477 ms, 9103.9 GFLOPS, memory
  B=8, S=2048: 1.0126 ms, 13394.3 GFLOPS, memory
  B=16, S=128: 0.0661 ms, 1737.2 GFLOPS, memory
  B=16, S=256: 0.1184 ms, 3694.4 GFLOPS, memory
  B=16, S=512: 0.2814 ms, 6064.5 GFLOPS, memory
  B=16, S=1024: 0.7346 ms, 9578.1 GFLOPS, memory
  B=16, S=2048: 2.0546 ms, 13903.0 GFLOPS, memory
  B=32, S=128: 0.1294 ms, 1695.0 GFLOPS, memory
  B=32, S=256: 0.2327 ms, 3831.9 GFLOPS, memory
  B=32, S=512: 0.5739 ms, 6395.6 GFLOPS, memory
  B=32, S=1024: 1.4716 ms, 9913.6 GFLOPS, memory
  B=32, S=2048: 4.2750 ms, 14178.5 GFLOPS, memory
  B=64, S=128: 0.2567 ms, 1687.8 GFLOPS, memory
  B=64, S=256: 0.4594 ms, 3657.8 GFLOPS, memory
  B=64, S=512: 1.1473 ms, 6281.0 GFLOPS, memory
  B=64, S=1024: 2.9721 ms, 9930.4 GFLOPS, memory
  B=64, S=2048: 7.9622 ms, 14543.3 GFLOPS, memory
  B=128, S=128: 0.5110 ms, 1754.7 GFLOPS, memory
  B=128, S=256: 0.9255 ms, 3694.9 GFLOPS, memory
  B=128, S=512: 2.2915 ms, 6113.8 GFLOPS, memory
  B=128, S=1024: 5.7243 ms, 9802.3 GFLOPS, memory
Warning: Kernel failed for B=128, S=2048: Error in function 'aligned_alloc' at /usr/local/lib/python3.12/dist-packages/flashinfer/data/include/flashinfer/allocator.h:49: Buffer overflow when allocating memory for trtllm_gen_softmax_workspace with size 200737792 and alignment 16, but only 125829120 bytes available in AlignedAllocator. Increase the workspace buffer size.
Saved ../results/trtllm_ragged_attention_deepseek.csv

[OK] trtllm_ragged_attention_deepseek completed successfully

======================================================================
Running: mla_rope_quantize_fp8 (Attention, Memory)
======================================================================
============================================================
Benchmark: rope_quantize_fp8 (MLA config) (Kernel #10)
MLA: 128 Q heads, 1 K head, 64 rope_dim + 512 no_rope_dim
============================================================

=== MLA RoPE + FP8 Quantization ===
  tokens=128: 0.0064 ms, 4624.6 GB/s, 57.8% peak
  tokens=256: 0.0114 ms, 5093.3 GB/s, 63.7% peak
  tokens=512: 0.0239 ms, 4827.2 GB/s, 60.3% peak
  tokens=1024: 0.0468 ms, 4900.8 GB/s, 61.3% peak
  tokens=2048: 0.0921 ms, 4969.8 GB/s, 62.1% peak
  tokens=4096: 0.1838 ms, 4972.0 GB/s, 62.2% peak
  tokens=8192: 0.3692 ms, 4952.1 GB/s, 61.9% peak
  tokens=16384: 0.7516 ms, 4864.8 GB/s, 60.8% peak
  tokens=32768: 1.5469 ms, 4727.2 GB/s, 59.1% peak
  tokens=65536: 3.0804 ms, 4747.9 GB/s, 59.3% peak
  tokens=131072: 6.1604 ms, 4748.3 GB/s, 59.4% peak
  tokens=262144: 13.9016 ms, 4208.3 GB/s, 52.6% peak
Saved ../results/mla_rope_quantize_fp8.csv

[OK] mla_rope_quantize_fp8 completed successfully

======================================================================
Running: apply_rope_with_cos_sin_cache_inplace (RoPE, Memory)
======================================================================
============================================================
Benchmark: apply_rope_with_cos_sin_cache_inplace (Kernel #11)
============================================================

=== Decode Phase ===
  B=1: 0.0017 ms, 348.0 GB/s, 4.3% peak
  B=2: 0.0017 ms, 385.7 GB/s, 4.8% peak
  B=4: 0.0017 ms, 460.2 GB/s, 5.8% peak
  B=8: 0.0018 ms, 594.1 GB/s, 7.4% peak
  B=16: 0.0018 ms, 878.9 GB/s, 11.0% peak
  B=32: 0.0019 ms, 1398.6 GB/s, 17.5% peak
  B=64: 0.0022 ms, 2191.1 GB/s, 27.4% peak
  B=128: 0.0033 ms, 2712.6 GB/s, 33.9% peak

=== Prefill Phase ===
  B=1, S=128: 0.0033 ms, 2738.2 GB/s, 34.2% peak
  B=1, S=256: 0.0046 ms, 3756.1 GB/s, 47.0% peak
  B=1, S=512: 0.0073 ms, 4666.9 GB/s, 58.3% peak
  B=1, S=1024: 0.0128 ms, 5285.4 GB/s, 66.1% peak
  B=1, S=2048: 0.0243 ms, 5538.0 GB/s, 69.2% peak
  B=2, S=128: 0.0046 ms, 3739.7 GB/s, 46.7% peak
  B=2, S=256: 0.0073 ms, 4658.5 GB/s, 58.2% peak
  B=2, S=512: 0.0128 ms, 5284.5 GB/s, 66.1% peak
  B=2, S=1024: 0.0244 ms, 5512.2 GB/s, 68.9% peak
  B=2, S=2048: 0.0678 ms, 3964.7 GB/s, 49.6% peak
  B=4, S=128: 0.0073 ms, 4658.9 GB/s, 58.2% peak
  B=4, S=256: 0.0127 ms, 5312.9 GB/s, 66.4% peak
  B=4, S=512: 0.0241 ms, 5581.3 GB/s, 69.8% peak
  B=4, S=1024: 0.0675 ms, 3983.0 GB/s, 49.8% peak
  B=4, S=2048: 0.1381 ms, 3892.5 GB/s, 48.7% peak
  B=8, S=128: 0.0127 ms, 5323.5 GB/s, 66.5% peak
  B=8, S=256: 0.0240 ms, 5605.8 GB/s, 70.1% peak
  B=8, S=512: 0.0672 ms, 4005.6 GB/s, 50.1% peak
  B=8, S=1024: 0.1375 ms, 3909.4 GB/s, 48.9% peak
  B=8, S=2048: 0.2836 ms, 3789.0 GB/s, 47.4% peak
Saved ../results/apply_rope_with_cos_sin_cache_inplace.csv

[OK] apply_rope_with_cos_sin_cache_inplace completed successfully

======================================================================
Running: concat_mla_k (Concat, Memory)
======================================================================
============================================================
Benchmark: concat_mla_k (Kernel #12)
============================================================

=== Decode Phase ===
  B=1: 0.0021 ms, 39.0 GB/s, 0.5% peak
  B=2: 0.0030 ms, 54.7 GB/s, 0.7% peak
  B=4: 0.0048 ms, 68.2 GB/s, 0.9% peak
  B=8: 0.0048 ms, 135.6 GB/s, 1.7% peak
  B=16: 0.0049 ms, 270.3 GB/s, 3.4% peak
  B=32: 0.0049 ms, 541.1 GB/s, 6.8% peak
  B=64: 0.0049 ms, 1079.2 GB/s, 13.5% peak
  B=128: 0.0049 ms, 2145.4 GB/s, 26.8% peak

=== Prefill Phase ===
  B=1, S=128: 0.0049 ms, 2145.8 GB/s, 26.8% peak
  B=1, S=256: 0.0050 ms, 4203.1 GB/s, 52.5% peak
  B=1, S=512: 0.0054 ms, 7760.6 GB/s, 97.0% peak
  B=1, S=1024: 0.0107 ms, 7879.6 GB/s, 98.5% peak
  B=1, S=2048: 0.0274 ms, 6138.0 GB/s, 76.7% peak
  B=2, S=128: 0.0050 ms, 4195.0 GB/s, 52.4% peak
  B=2, S=256: 0.0051 ms, 8290.6 GB/s, 103.6% peak
  B=2, S=512: 0.0096 ms, 8756.9 GB/s, 109.5% peak
  B=2, S=1024: 0.0272 ms, 6177.2 GB/s, 77.2% peak
  B=2, S=2048: 0.0523 ms, 6426.9 GB/s, 80.3% peak
  B=4, S=128: 0.0051 ms, 8283.6 GB/s, 103.5% peak
  B=4, S=256: 0.0095 ms, 8840.8 GB/s, 110.5% peak
  B=4, S=512: 0.0270 ms, 6220.8 GB/s, 77.8% peak
  B=4, S=1024: 0.0524 ms, 6417.1 GB/s, 80.2% peak
  B=4, S=2048: 0.1011 ms, 6649.2 GB/s, 83.1% peak
  B=8, S=128: 0.0094 ms, 8921.4 GB/s, 111.5% peak
  B=8, S=256: 0.0274 ms, 6135.0 GB/s, 76.7% peak
  B=8, S=512: 0.0526 ms, 6385.0 GB/s, 79.8% peak
  B=8, S=1024: 0.1012 ms, 6644.8 GB/s, 83.1% peak
  B=8, S=2048: 0.1980 ms, 6789.0 GB/s, 84.9% peak
Saved ../results/concat_mla_k.csv

[OK] concat_mla_k completed successfully

======================================================================
Running: silu_and_mul (Activation, Memory)
======================================================================
============================================================
Benchmark: silu_and_mul (Kernel #13)
============================================================

=== Decode Phase ===
  B=1: 0.0018 ms, 6.7 GB/s, 0.1% peak
  B=2: 0.0018 ms, 13.5 GB/s, 0.2% peak
  B=4: 0.0018 ms, 27.0 GB/s, 0.3% peak
  B=8: 0.0018 ms, 54.1 GB/s, 0.7% peak
  B=16: 0.0019 ms, 105.3 GB/s, 1.3% peak
  B=32: 0.0019 ms, 209.7 GB/s, 2.6% peak
  B=64: 0.0019 ms, 413.2 GB/s, 5.2% peak
  B=128: 0.0019 ms, 811.6 GB/s, 10.1% peak

=== Prefill Phase ===
  B=1, S=128: 0.0019 ms, 812.6 GB/s, 10.2% peak
  B=1, S=256: 0.0021 ms, 1476.4 GB/s, 18.5% peak
  B=1, S=512: 0.0028 ms, 2255.1 GB/s, 28.2% peak
  B=1, S=1024: 0.0038 ms, 3294.5 GB/s, 41.2% peak
  B=1, S=2048: 0.0058 ms, 4354.7 GB/s, 54.4% peak
  B=2, S=128: 0.0021 ms, 1481.0 GB/s, 18.5% peak
  B=2, S=256: 0.0028 ms, 2254.5 GB/s, 28.2% peak
  B=2, S=512: 0.0038 ms, 3304.9 GB/s, 41.3% peak
  B=2, S=1024: 0.0058 ms, 4356.8 GB/s, 54.5% peak
  B=2, S=2048: 0.0098 ms, 5121.7 GB/s, 64.0% peak
  B=4, S=128: 0.0029 ms, 2168.0 GB/s, 27.1% peak
  B=4, S=256: 0.0038 ms, 3297.8 GB/s, 41.2% peak
  B=4, S=512: 0.0058 ms, 4357.3 GB/s, 54.5% peak
  B=4, S=1024: 0.0099 ms, 5104.5 GB/s, 63.8% peak
  B=4, S=2048: 0.0198 ms, 5081.5 GB/s, 63.5% peak
  B=8, S=128: 0.0038 ms, 3283.1 GB/s, 41.0% peak
  B=8, S=256: 0.0058 ms, 4338.3 GB/s, 54.2% peak
  B=8, S=512: 0.0098 ms, 5111.8 GB/s, 63.9% peak
  B=8, S=1024: 0.0199 ms, 5060.1 GB/s, 63.3% peak
  B=8, S=2048: 0.0400 ms, 5034.2 GB/s, 62.9% peak
Saved ../results/silu_and_mul.csv

[OK] silu_and_mul completed successfully

======================================================================
Running: topk_softmax (MoE Routing, Memory)
======================================================================
============================================================
Benchmark: topk_softmax (Kernel #14)
============================================================

=== Decode Phase ===
  B=1: 0.0035 ms, 0.3 GB/s, 0.0% peak
  B=2: 0.0034 ms, 0.6 GB/s, 0.0% peak
  B=4: 0.0035 ms, 1.3 GB/s, 0.0% peak
  B=8: 0.0035 ms, 2.5 GB/s, 0.0% peak
  B=16: 0.0035 ms, 5.0 GB/s, 0.1% peak
  B=32: 0.0035 ms, 10.1 GB/s, 0.1% peak
  B=64: 0.0035 ms, 20.0 GB/s, 0.2% peak
  B=128: 0.0035 ms, 39.8 GB/s, 0.5% peak

=== Prefill Phase ===
  B=1, S=128: 0.0035 ms, 39.8 GB/s, 0.5% peak
  B=1, S=256: 0.0035 ms, 78.7 GB/s, 1.0% peak
  B=1, S=512: 0.0036 ms, 156.3 GB/s, 2.0% peak
  B=1, S=1024: 0.0039 ms, 287.0 GB/s, 3.6% peak
  B=1, S=2048: 0.0053 ms, 424.1 GB/s, 5.3% peak
  B=2, S=128: 0.0035 ms, 78.8 GB/s, 1.0% peak
  B=2, S=256: 0.0036 ms, 156.3 GB/s, 2.0% peak
  B=2, S=512: 0.0039 ms, 287.0 GB/s, 3.6% peak
  B=2, S=1024: 0.0053 ms, 424.2 GB/s, 5.3% peak
  B=2, S=2048: 0.0078 ms, 574.5 GB/s, 7.2% peak
  B=4, S=128: 0.0036 ms, 156.3 GB/s, 2.0% peak
  B=4, S=256: 0.0039 ms, 287.0 GB/s, 3.6% peak
  B=4, S=512: 0.0053 ms, 424.0 GB/s, 5.3% peak
  B=4, S=1024: 0.0078 ms, 574.5 GB/s, 7.2% peak
  B=4, S=2048: 0.0133 ms, 672.4 GB/s, 8.4% peak
  B=8, S=128: 0.0039 ms, 286.9 GB/s, 3.6% peak
  B=8, S=256: 0.0053 ms, 424.2 GB/s, 5.3% peak
  B=8, S=512: 0.0078 ms, 574.5 GB/s, 7.2% peak
  B=8, S=1024: 0.0133 ms, 672.5 GB/s, 8.4% peak
  B=8, S=2048: 0.0237 ms, 753.1 GB/s, 9.4% peak
Saved ../results/topk_softmax.csv

[OK] topk_softmax completed successfully

======================================================================
Running: topk_sigmoid (MoE Routing, Memory)
======================================================================
============================================================
Benchmark: topk_sigmoid (Kernel #15)
============================================================

=== Decode Phase ===
  B=1: 0.0035 ms, 0.3 GB/s, 0.0% peak
  B=2: 0.0035 ms, 0.6 GB/s, 0.0% peak
  B=4: 0.0037 ms, 1.2 GB/s, 0.0% peak
  B=8: 0.0037 ms, 2.3 GB/s, 0.0% peak
  B=16: 0.0037 ms, 4.7 GB/s, 0.1% peak
  B=32: 0.0037 ms, 9.3 GB/s, 0.1% peak
  B=64: 0.0038 ms, 18.5 GB/s, 0.2% peak
  B=128: 0.0038 ms, 37.0 GB/s, 0.5% peak

=== Prefill Phase ===
  B=1, S=128: 0.0038 ms, 37.0 GB/s, 0.5% peak
  B=1, S=256: 0.0038 ms, 73.4 GB/s, 0.9% peak
  B=1, S=512: 0.0038 ms, 145.5 GB/s, 1.8% peak
  B=1, S=1024: 0.0041 ms, 271.8 GB/s, 3.4% peak
  B=1, S=2048: 0.0053 ms, 417.6 GB/s, 5.2% peak
  B=2, S=128: 0.0038 ms, 73.4 GB/s, 0.9% peak
  B=2, S=256: 0.0038 ms, 145.6 GB/s, 1.8% peak
  B=2, S=512: 0.0041 ms, 271.7 GB/s, 3.4% peak
  B=2, S=1024: 0.0053 ms, 417.7 GB/s, 5.2% peak
  B=2, S=2048: 0.0077 ms, 578.7 GB/s, 7.2% peak
  B=4, S=128: 0.0038 ms, 145.6 GB/s, 1.8% peak
  B=4, S=256: 0.0041 ms, 271.7 GB/s, 3.4% peak
  B=4, S=512: 0.0053 ms, 417.5 GB/s, 5.2% peak
  B=4, S=1024: 0.0077 ms, 578.8 GB/s, 7.2% peak
  B=4, S=2048: 0.0129 ms, 688.5 GB/s, 8.6% peak
  B=8, S=128: 0.0041 ms, 271.8 GB/s, 3.4% peak
  B=8, S=256: 0.0053 ms, 417.6 GB/s, 5.2% peak
  B=8, S=512: 0.0077 ms, 578.6 GB/s, 7.2% peak
  B=8, S=1024: 0.0129 ms, 688.4 GB/s, 8.6% peak
  B=8, S=2048: 0.0228 ms, 780.6 GB/s, 9.8% peak
Saved ../results/topk_sigmoid.csv

[OK] topk_sigmoid completed successfully

======================================================================
Running: moe_fused_gate (MoE Routing, Memory)
======================================================================
============================================================
Benchmark: moe_fused_gate (Kernel #16)
============================================================

=== Decode Phase ===
  B=1: 0.0110 ms, 0.2 GB/s, 0.0% peak
  B=2: 0.0110 ms, 0.3 GB/s, 0.0% peak
  B=4: 0.0114 ms, 0.5 GB/s, 0.0% peak
  B=8: 0.0121 ms, 0.8 GB/s, 0.0% peak
  B=16: 0.0137 ms, 1.3 GB/s, 0.0% peak
  B=32: 0.0158 ms, 2.3 GB/s, 0.0% peak
  B=64: 0.0158 ms, 4.5 GB/s, 0.1% peak
  B=128: 0.0157 ms, 8.9 GB/s, 0.1% peak

=== Prefill Phase ===
  B=1, S=128: 0.0157 ms, 8.9 GB/s, 0.1% peak
  B=1, S=256: 0.0156 ms, 18.0 GB/s, 0.2% peak
  B=1, S=512: 0.0158 ms, 35.3 GB/s, 0.4% peak
  B=1, S=1024: 0.0159 ms, 70.0 GB/s, 0.9% peak
  B=1, S=2048: 0.0160 ms, 139.5 GB/s, 1.7% peak
  B=2, S=128: 0.0158 ms, 17.7 GB/s, 0.2% peak
  B=2, S=256: 0.0158 ms, 35.4 GB/s, 0.4% peak
  B=2, S=512: 0.0157 ms, 71.0 GB/s, 0.9% peak
  B=2, S=1024: 0.0158 ms, 141.3 GB/s, 1.8% peak
  B=2, S=2048: 0.0218 ms, 204.6 GB/s, 2.6% peak
  B=4, S=128: 0.0158 ms, 35.4 GB/s, 0.4% peak
  B=4, S=256: 0.0157 ms, 71.1 GB/s, 0.9% peak
  B=4, S=512: 0.0161 ms, 138.8 GB/s, 1.7% peak
  B=4, S=1024: 0.0217 ms, 205.8 GB/s, 2.6% peak
  B=4, S=2048: 0.0291 ms, 306.8 GB/s, 3.8% peak
  B=8, S=128: 0.0157 ms, 71.0 GB/s, 0.9% peak
  B=8, S=256: 0.0159 ms, 140.3 GB/s, 1.8% peak
  B=8, S=512: 0.0216 ms, 206.1 GB/s, 2.6% peak
  B=8, S=1024: 0.0292 ms, 305.3 GB/s, 3.8% peak
  B=8, S=2048: 0.0448 ms, 397.9 GB/s, 5.0% peak
Saved ../results/moe_fused_gate.csv

[OK] moe_fused_gate completed successfully

======================================================================
Running: prepare_moe_input (MoE, Memory)
======================================================================
============================================================
Benchmark: prepare_moe_input (Kernel #17)
============================================================

=== Decode Phase ===
  B=1: 0.0142 ms, 0.2 GB/s, 0.0% peak
  B=2: 0.0143 ms, 0.2 GB/s, 0.0% peak
  B=4: 0.0143 ms, 0.2 GB/s, 0.0% peak
  B=8: 0.0142 ms, 0.3 GB/s, 0.0% peak
  B=16: 0.0146 ms, 0.3 GB/s, 0.0% peak
  B=32: 0.0158 ms, 0.4 GB/s, 0.0% peak
  B=64: 0.0178 ms, 0.5 GB/s, 0.0% peak
  B=128: 0.0197 ms, 0.8 GB/s, 0.0% peak

=== Prefill Phase ===
  B=1, S=128: 0.0196 ms, 0.8 GB/s, 0.0% peak
  B=1, S=256: 0.0198 ms, 1.4 GB/s, 0.0% peak
  B=1, S=512: 0.0217 ms, 2.4 GB/s, 0.0% peak
  B=1, S=1024: 0.0258 ms, 3.9 GB/s, 0.0% peak
  B=1, S=2048: 0.0306 ms, 6.5 GB/s, 0.1% peak
  B=2, S=128: 0.0198 ms, 1.4 GB/s, 0.0% peak
  B=2, S=256: 0.0219 ms, 2.4 GB/s, 0.0% peak
  B=2, S=512: 0.0263 ms, 3.9 GB/s, 0.0% peak
  B=2, S=1024: 0.0307 ms, 6.5 GB/s, 0.1% peak
  B=2, S=2048: 0.0481 ms, 8.2 GB/s, 0.1% peak
  B=4, S=128: 0.0219 ms, 2.4 GB/s, 0.0% peak
  B=4, S=256: 0.0253 ms, 4.0 GB/s, 0.1% peak
  B=4, S=512: 0.0302 ms, 6.6 GB/s, 0.1% peak
  B=4, S=1024: 0.0476 ms, 8.3 GB/s, 0.1% peak
  B=4, S=2048: 0.0768 ms, 10.3 GB/s, 0.1% peak
  B=8, S=128: 0.0256 ms, 4.0 GB/s, 0.0% peak
  B=8, S=256: 0.0312 ms, 6.4 GB/s, 0.1% peak
  B=8, S=512: 0.0474 ms, 8.4 GB/s, 0.1% peak
  B=8, S=1024: 0.0758 ms, 10.4 GB/s, 0.1% peak
  B=8, S=2048: 0.1314 ms, 12.0 GB/s, 0.1% peak
Saved ../results/prepare_moe_input.csv

[OK] prepare_moe_input completed successfully

======================================================================
Running: scaled_fp4_experts_quant (MoE, Memory)
======================================================================
============================================================
Benchmark: scaled_fp4_experts_quant (Kernel #18)
============================================================

=== Decode Phase ===
  B=1: 0.0074 ms, 19.8 GB/s, 0.2% peak
  B=2: 0.0075 ms, 39.3 GB/s, 0.5% peak
  B=4: 0.0075 ms, 78.4 GB/s, 1.0% peak
  B=8: 0.0079 ms, 148.7 GB/s, 1.9% peak
  B=16: 0.0091 ms, 257.0 GB/s, 3.2% peak
  B=32: 0.0122 ms, 384.0 GB/s, 4.8% peak
  B=64: 0.0067 ms, 1396.4 GB/s, 17.5% peak
  B=128: 0.0108 ms, 1739.2 GB/s, 21.7% peak

=== Prefill Phase ===
  B=1, S=128: 0.0108 ms, 1737.2 GB/s, 21.7% peak
Warning: Kernel failed for B=1, S=256: CUDA error: an illegal memory access was encountered
Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


Traceback (most recent call last):
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_scaled_fp4_experts_quant.py", line 169, in <module>
    main()
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_scaled_fp4_experts_quant.py", line 165, in main
    run_benchmarks(batch_sizes, seq_lens, args.output)
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_scaled_fp4_experts_quant.py", line 139, in run_benchmarks
    result = bench_scaled_fp4_experts_quant(sgl_kernel, B, S, H, E, K, "prefill")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_scaled_fp4_experts_quant.py", line 48, in bench_scaled_fp4_experts_quant
    expert_inputs = torch.randn(total_expert_tokens, hidden_size, dtype=torch.bfloat16, device=device)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.AcceleratorError: CUDA error: an illegal memory access was encountered
Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


[FAILED] scaled_fp4_experts_quant: Exit code 1

======================================================================
Running: cutlass_fp4_group_mm (MoE, Compute)
======================================================================
============================================================
Benchmark: cutlass_fp4_group_mm (Kernel #19)
============================================================

=== Decode Phase: gate_up ===
  B=1: 0.0486 ms, 9670.4 GFLOPS, 0.11% peak
  B=2: 0.0563 ms, 16692.5 GFLOPS, 0.19% peak
  B=4: 0.0464 ms, 40522.0 GFLOPS, 0.45% peak
  B=8: 0.0457 ms, 82219.2 GFLOPS, 0.91% peak
  B=16: 0.0508 ms, 147828.9 GFLOPS, 1.64% peak
Warning: Kernel failed for B=32, S=1, op=gate_up: CUDA error: an illegal memory access was encountered
Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


Traceback (most recent call last):
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_cutlass_fp4_group_mm.py", line 229, in <module>
    main()
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_cutlass_fp4_group_mm.py", line 225, in main
    run_benchmarks(batch_sizes, seq_lens, args.output)
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_cutlass_fp4_group_mm.py", line 175, in run_benchmarks
    result = bench_cutlass_fp4_group_mm(sgl_kernel, B, 1, E, K, H, I, "gate_up", "decode")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_cutlass_fp4_group_mm.py", line 62, in bench_cutlass_fp4_group_mm
    a = torch.randn((M, K_dim), dtype=torch.bfloat16, device=device)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.AcceleratorError: CUDA error: an illegal memory access was encountered
Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


[FAILED] cutlass_fp4_group_mm: Exit code 1

======================================================================
Running: apply_shuffle_mul_sum (MoE, Memory)
======================================================================
============================================================
Benchmark: apply_shuffle_mul_sum (Kernel #20)
============================================================

=== Decode Phase ===
  B=1: 0.0030 ms, 43.2 GB/s, 0.5% peak
  B=2: 0.0030 ms, 87.2 GB/s, 1.1% peak
  B=4: 0.0029 ms, 175.2 GB/s, 2.2% peak
  B=8: 0.0030 ms, 347.6 GB/s, 4.3% peak
  B=16: 0.0030 ms, 690.7 GB/s, 8.6% peak
  B=32: 0.0030 ms, 1367.6 GB/s, 17.1% peak
  B=64: 0.0030 ms, 2725.2 GB/s, 34.1% peak
  B=128: 0.0031 ms, 5352.4 GB/s, 66.9% peak

=== Prefill Phase ===
  B=1, S=128: 0.0031 ms, 5352.3 GB/s, 66.9% peak
  B=1, S=256: 0.0041 ms, 7967.4 GB/s, 99.6% peak
  B=1, S=512: 0.0066 ms, 9982.5 GB/s, 124.8% peak
  B=1, S=1024: 0.0105 ms, 12608.6 GB/s, 157.6% peak
  B=1, S=2048: 0.0191 ms, 13868.3 GB/s, 173.4% peak
  B=2, S=128: 0.0042 ms, 7952.5 GB/s, 99.4% peak
  B=2, S=256: 0.0066 ms, 9981.9 GB/s, 124.8% peak
  B=2, S=512: 0.0105 ms, 12607.1 GB/s, 157.6% peak
  B=2, S=1024: 0.0192 ms, 13758.2 GB/s, 172.0% peak
  B=2, S=2048: 0.0381 ms, 13874.0 GB/s, 173.4% peak
  B=4, S=128: 0.0066 ms, 9956.0 GB/s, 124.5% peak
  B=4, S=256: 0.0105 ms, 12580.6 GB/s, 157.3% peak
  B=4, S=512: 0.0194 ms, 13633.8 GB/s, 170.4% peak
  B=4, S=1024: 0.0381 ms, 13862.9 GB/s, 173.3% peak
  B=4, S=2048: 0.0735 ms, 14383.9 GB/s, 179.8% peak
  B=8, S=128: 0.0105 ms, 12583.4 GB/s, 157.3% peak
  B=8, S=256: 0.0191 ms, 13824.4 GB/s, 172.8% peak
  B=8, S=512: 0.0381 ms, 13863.0 GB/s, 173.3% peak
  B=8, S=1024: 0.0735 ms, 14386.6 GB/s, 179.8% peak
  B=8, S=2048: 0.1434 ms, 14744.4 GB/s, 184.3% peak
Saved ../results/apply_shuffle_mul_sum.csv

[OK] apply_shuffle_mul_sum completed successfully

======================================================================
Running: moe_align_block_size (MoE, Memory)
======================================================================
============================================================
Benchmark: moe_align_block_size (Kernel #21)
============================================================

=== Decode Phase ===
  B=1: 0.0043 ms, 15.8 GB/s, 0.2% peak
  B=2: 0.0043 ms, 15.7 GB/s, 0.2% peak
  B=4: 0.0043 ms, 15.7 GB/s, 0.2% peak
  B=8: 0.0043 ms, 15.7 GB/s, 0.2% peak
  B=16: 0.0044 ms, 15.6 GB/s, 0.2% peak
  B=32: 0.0043 ms, 16.3 GB/s, 0.2% peak
  B=64: 0.0043 ms, 16.6 GB/s, 0.2% peak
  B=128: 0.0045 ms, 16.9 GB/s, 0.2% peak

=== Prefill Phase ===
  B=1, S=128: 0.0045 ms, 16.9 GB/s, 0.2% peak
  B=1, S=256: 0.0047 ms, 17.7 GB/s, 0.2% peak
  B=1, S=512: 0.0056 ms, 18.1 GB/s, 0.2% peak
  B=1, S=1024: 0.0072 ms, 18.5 GB/s, 0.2% peak
  B=1, S=2048: 0.0087 ms, 23.0 GB/s, 0.3% peak
  B=2, S=128: 0.0048 ms, 17.7 GB/s, 0.2% peak
  B=2, S=256: 0.0056 ms, 18.0 GB/s, 0.2% peak
  B=2, S=512: 0.0072 ms, 18.6 GB/s, 0.2% peak
  B=2, S=1024: 0.0087 ms, 23.0 GB/s, 0.3% peak
  B=2, S=2048: 0.0136 ms, 24.4 GB/s, 0.3% peak
  B=4, S=128: 0.0055 ms, 18.2 GB/s, 0.2% peak
  B=4, S=256: 0.0072 ms, 18.5 GB/s, 0.2% peak
  B=4, S=512: 0.0086 ms, 23.1 GB/s, 0.3% peak
  B=4, S=1024: 0.0136 ms, 24.4 GB/s, 0.3% peak
  B=4, S=2048: 0.0233 ms, 25.6 GB/s, 0.3% peak
  B=8, S=128: 0.0072 ms, 18.6 GB/s, 0.2% peak
  B=8, S=256: 0.0087 ms, 23.0 GB/s, 0.3% peak
  B=8, S=512: 0.0136 ms, 24.3 GB/s, 0.3% peak
  B=8, S=1024: 0.0233 ms, 25.6 GB/s, 0.3% peak
  B=8, S=2048: 0.0421 ms, 26.7 GB/s, 0.3% peak
Saved ../results/moe_align_block_size.csv

[OK] moe_align_block_size completed successfully

======================================================================
Running: trtllm_fp4_block_scale_moe (MoE, Mixed)
======================================================================
============================================================
Benchmark: trtllm_fp4_block_scale_moe (Kernel #22)
============================================================

=== Decode Phase ===
  B=1: Skipped (minimum batch size for FP4 MoE is 32)
  B=2: Skipped (minimum batch size for FP4 MoE is 32)
  B=4: Skipped (minimum batch size for FP4 MoE is 32)
  B=8: Skipped (minimum batch size for FP4 MoE is 32)
  B=16: Skipped (minimum batch size for FP4 MoE is 32)
Warning: Kernel failed for B=32, S=1: Error in function 'run' at /usr/local/lib/python3.12/dist-packages/flashinfer/data/csrc/trtllm_batched_gemm_runner.cu:258: Error occurred when running GEMM! (numBatches:  256 , GemmMNK:  32   4096   7168 , Kernel:  bmm_E2m1_E2m1E2m1_Fp32_t128x8x512u2_s5_et128x8_m128x8x64_cga1x1x1_16dp256b_rM_TN_transOut_schedP2x1x2x3_bN_ldgsts_tmaOpt_clmp_swiGlu_dynBatch_sm100f )

Traceback (most recent call last):
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_trtllm_fp4_block_scale_moe.py", line 318, in <module>
    main()
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_trtllm_fp4_block_scale_moe.py", line 314, in main
    run_benchmarks(batch_sizes, seq_lens, args.output)
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_trtllm_fp4_block_scale_moe.py", line 279, in run_benchmarks
    result = bench_trtllm_fp4_block_scale_moe(flashinfer, B, 1, H, E, K, I, "decode")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_trtllm_fp4_block_scale_moe.py", line 95, in bench_trtllm_fp4_block_scale_moe
    torch.manual_seed(42)
  File "/usr/local/lib/python3.12/dist-packages/torch/random.py", line 46, in manual_seed
    torch.cuda.manual_seed_all(seed)
  File "/usr/local/lib/python3.12/dist-packages/torch/cuda/random.py", line 131, in manual_seed_all
    _lazy_call(cb, seed_all=True)
  File "/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py", line 341, in _lazy_call
    callable()
  File "/usr/local/lib/python3.12/dist-packages/torch/cuda/random.py", line 129, in cb
    default_generator.manual_seed(seed)
torch.AcceleratorError: CUDA error: an illegal memory access was encountered
Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


[FAILED] trtllm_fp4_block_scale_moe: Exit code 1

======================================================================
Running: fused_moe_kernel (MoE, Mixed)
======================================================================
============================================================
Benchmark: fused_moe_kernel (Kernel #23)
============================================================

=== Decode Phase ===
  B=1: 0.1338 ms, 5265.3 GFLOPS, 2106.11% peak (memory)
  B=2: 0.2776 ms, 5076.4 GFLOPS, 1015.28% peak (memory)
  B=4: 0.4804 ms, 5866.8 GFLOPS, 586.68% peak (memory)
  B=8: 0.7859 ms, 7172.7 GFLOPS, 358.64% peak (memory)
  B=16: 1.3933 ms, 8091.8 GFLOPS, 202.30% peak (memory)
  B=32: 2.1844 ms, 10322.3 GFLOPS, 129.03% peak (memory)
  B=64: 3.0509 ms, 14781.5 GFLOPS, 92.39% peak (memory)
  B=128: 3.4098 ms, 26451.1 GFLOPS, 82.67% peak (memory)

=== Prefill Phase ===
  B=1, S=128: 3.4268 ms, 26320.4 GFLOPS, 82.26% peak (memory)
  B=1, S=256: 3.5173 ms, 51285.6 GFLOPS, 80.16% peak (memory)
  B=1, S=512: 3.9057 ms, 92372.7 GFLOPS, 72.21% peak (memory)
  B=1, S=1024: 4.0791 ms, 176890.8 GFLOPS, 69.19% peak (memory)
  B=1, S=2048: 5.4590 ms, 264355.8 GFLOPS, 51.77% peak (memory)
  B=2, S=128: 3.5197 ms, 51251.3 GFLOPS, 80.11% peak (memory)
  B=2, S=256: 3.9065 ms, 92352.7 GFLOPS, 72.20% peak (memory)
  B=2, S=512: 4.0877 ms, 176520.2 GFLOPS, 69.04% peak (memory)
  B=2, S=1024: 5.2481 ms, 274976.5 GFLOPS, 53.85% peak (memory)
  B=2, S=2048: 8.1123 ms, 355782.8 GFLOPS, 34.93% peak (memory)
  B=4, S=128: 3.9075 ms, 92328.7 GFLOPS, 72.18% peak (memory)
  B=4, S=256: 4.0837 ms, 176691.4 GFLOPS, 69.11% peak (memory)
  B=4, S=512: 5.3252 ms, 270995.7 GFLOPS, 53.07% peak (memory)
  B=4, S=1024: 8.2878 ms, 348248.0 GFLOPS, 34.19% peak (memory)
  B=4, S=2048: 14.0063 ms, 412131.8 GFLOPS, 20.33% peak (memory)
  B=8, S=128: 4.0827 ms, 176736.4 GFLOPS, 69.13% peak (memory)
  B=8, S=256: 5.3524 ms, 269619.3 GFLOPS, 52.80% peak (memory)
  B=8, S=512: 8.2786 ms, 348635.0 GFLOPS, 34.22% peak (memory)
  B=8, S=1024: 14.2029 ms, 406427.2 GFLOPS, 20.05% peak (memory)
  B=8, S=2048: 32.6205 ms, 353914.5 GFLOPS, 15.73% peak (compute)
Saved ../results/fused_moe_kernel.csv

[2026-01-27 20:38:05] WARNING fused_moe_triton_config.py:127: Using default MoE kernel config. Performance might be sub-optimal! Config file not found at /lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/sglang/python/sglang/srt/layers/moe/fused_moe_triton/configs/triton_3_5_1/E=256,N=2048,device_name=NVIDIA_GB200.json, you can create them with https://github.com/sgl-project/sglang/tree/main/benchmark/kernels/fused_moe_triton
[2026-01-27 20:38:05] WARNING fused_moe_triton_config.py:119: Using MoE kernel config with down_moe=False. Performance might be sub-optimal! Config file not found at /lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/sglang/python/sglang/srt/layers/moe/fused_moe_triton/configs/triton_3_5_1/E=256,N=2048,device_name=NVIDIA_GB200_down.json, you can create them with https://github.com/sgl-project/sglang/tree/main/benchmark/kernels/fused_moe_triton

[OK] fused_moe_kernel completed successfully

Aggregated results saved to ../results/all_kernels.csv
Total benchmark results: 587

Summary saved to ../results/benchmark_summary.md

======================================================================
Benchmark Complete!
Successful: 20/23
Failed kernels:
  - scaled_fp4_experts_quant: Exit code 1
  - cutlass_fp4_group_mm: Exit code 1
  - trtllm_fp4_block_scale_moe: Exit code 1
======================================================================
