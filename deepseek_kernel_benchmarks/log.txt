======================================================================
DeepSeek-R1-NVFP4-v2 Kernel Benchmarks
======================================================================
Kernels to run: 1
Batch sizes: 1,2,4,8,16,32,64,128
Sequence lengths: 128,256,512,1024,2048
Output directory: ../results/

NOTE: Each kernel runs in a separate subprocess for isolation.
      CUDA crashes in one kernel will NOT affect other kernels.
======================================================================

======================================================================
Running: trtllm_fp4_block_scale_moe (MoE, Mixed)
======================================================================
============================================================
Benchmark: trtllm_fp4_block_scale_moe (Kernel #22)
============================================================

Running flashinfer benchmark CLI for trtllm_fp4_block_scale_moe...

=== Running flashinfer benchmark ===
  Benchmark script: /lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/../../flashinfer/benchmarks/flashinfer_benchmark.py
  Routing method: renormalize (type=1)

  decode B=1 (tokens=1, H=1024, I=1024, E=128, K=4):
    [PERF] trtllm         :: median time 0.011 ms; std 0.000 ms; achieved tflops 2.197 TFLOPs/sec; achieved tb_per_sec 0.618 TB/sec

  decode B=8 (tokens=8, H=1024, I=1024, E=128, K=8):
    [PERF] trtllm         :: median time 0.027 ms; std 0.000 ms; achieved tflops 14.788 TFLOPs/sec; achieved tb_per_sec 3.380 TB/sec

  prefill S=128 (tokens=128, H=1024, I=1024, E=128, K=8):
    [PERF] trtllm         :: median time 0.051 ms; std 0.000 ms; achieved tflops 126.370 TFLOPs/sec; achieved tb_per_sec 4.450 TB/sec

  prefill S=1024 (tokens=1024, H=1024, I=1024, E=128, K=8):
    [PERF] trtllm         :: median time 0.087 ms; std 0.000 ms; achieved tflops 589.105 TFLOPs/sec; achieved tb_per_sec 2.623 TB/sec

============================================================
Note: This benchmark uses flashinfer's official benchmark CLI.
============================================================

[FAILED] trtllm_fp4_block_scale_moe: No CSV output (kernel not available or all runs failed)

Aggregated results saved to ../results/all_kernels.csv
Total benchmark results: 606

Summary saved to ../results/benchmark_summary.md

======================================================================
Benchmark Complete!
Successful: 0/1
Failed kernels:
  - trtllm_fp4_block_scale_moe: No CSV output (kernel not available or all runs failed)
======================================================================
