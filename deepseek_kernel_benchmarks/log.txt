======================================================================
DeepSeek-R1-NVFP4-v2 Kernel Benchmarks
======================================================================
Kernels to run: 23
Batch sizes: 1,2,4,8,16,32,64,128
Sequence lengths: 128,256,512,1024,2048
Output directory: ../results/

NOTE: Each kernel runs in a separate subprocess for isolation.
      CUDA crashes in one kernel will NOT affect other kernels.
======================================================================

======================================================================
Running: rmsnorm (Norm, Memory)
======================================================================
============================================================
Benchmark: rmsnorm (Kernel #1)
============================================================

=== Decode Phase ===
  B=1: 0.0019 ms, 15.1 GB/s, 0.2% peak
  B=2: 0.0019 ms, 30.1 GB/s, 0.4% peak
  B=4: 0.0019 ms, 60.4 GB/s, 0.8% peak
  B=8: 0.0019 ms, 120.9 GB/s, 1.5% peak
  B=16: 0.0019 ms, 235.4 GB/s, 2.9% peak
  B=32: 0.0020 ms, 462.8 GB/s, 5.8% peak
  B=64: 0.0020 ms, 923.3 GB/s, 11.5% peak
  B=128: 0.0021 ms, 1770.9 GB/s, 22.1% peak

=== Prefill Phase ===
  B=1, S=128: 0.0021 ms, 1770.8 GB/s, 22.1% peak
  B=1, S=256: 0.0027 ms, 2760.9 GB/s, 34.5% peak
  B=1, S=512: 0.0046 ms, 3174.9 GB/s, 39.7% peak
  B=1, S=1024: 0.0081 ms, 3626.3 GB/s, 45.3% peak
  B=1, S=2048: 0.0149 ms, 3930.6 GB/s, 49.1% peak
  B=2, S=128: 0.0027 ms, 2758.3 GB/s, 34.5% peak
  B=2, S=256: 0.0046 ms, 3168.0 GB/s, 39.6% peak
  B=2, S=512: 0.0081 ms, 3625.2 GB/s, 45.3% peak
  B=2, S=1024: 0.0150 ms, 3919.5 GB/s, 49.0% peak
  B=2, S=2048: 0.0363 ms, 3238.0 GB/s, 40.5% peak
  B=4, S=128: 0.0046 ms, 3172.7 GB/s, 39.7% peak
  B=4, S=256: 0.0081 ms, 3622.8 GB/s, 45.3% peak
  B=4, S=512: 0.0150 ms, 3915.3 GB/s, 48.9% peak
  B=4, S=1024: 0.0366 ms, 3209.9 GB/s, 40.1% peak
  B=4, S=2048: 0.0703 ms, 3342.9 GB/s, 41.8% peak
  B=8, S=128: 0.0081 ms, 3621.6 GB/s, 45.3% peak
  B=8, S=256: 0.0150 ms, 3922.9 GB/s, 49.0% peak
  B=8, S=512: 0.0366 ms, 3210.4 GB/s, 40.1% peak
  B=8, S=1024: 0.0704 ms, 3337.5 GB/s, 41.7% peak
  B=8, S=2048: 0.1375 ms, 3417.5 GB/s, 42.7% peak
Saved ../results/rmsnorm.csv

[OK] rmsnorm completed successfully

======================================================================
Running: fused_add_rmsnorm (Norm, Memory)
======================================================================
============================================================
Benchmark: fused_add_rmsnorm (Kernel #2)
============================================================

=== Decode Phase ===
  B=1: 0.0023 ms, 24.4 GB/s, 0.3% peak
  B=2: 0.0023 ms, 48.9 GB/s, 0.6% peak
  B=4: 0.0024 ms, 97.6 GB/s, 1.2% peak
  B=8: 0.0025 ms, 186.4 GB/s, 2.3% peak
  B=16: 0.0024 ms, 376.9 GB/s, 4.7% peak
  B=32: 0.0025 ms, 739.9 GB/s, 9.2% peak
  B=64: 0.0024 ms, 1504.6 GB/s, 18.8% peak
  B=128: 0.0026 ms, 2874.5 GB/s, 35.9% peak

=== Prefill Phase ===
  B=1, S=128: 0.0026 ms, 2874.2 GB/s, 35.9% peak
  B=1, S=256: 0.0045 ms, 3276.7 GB/s, 41.0% peak
  B=1, S=512: 0.0081 ms, 3635.7 GB/s, 45.4% peak
  B=1, S=1024: 0.0143 ms, 4107.1 GB/s, 51.3% peak
  B=1, S=2048: 0.0272 ms, 4323.9 GB/s, 54.0% peak
  B=2, S=128: 0.0045 ms, 3239.3 GB/s, 40.5% peak
  B=2, S=256: 0.0081 ms, 3634.1 GB/s, 45.4% peak
  B=2, S=512: 0.0142 ms, 4134.5 GB/s, 51.7% peak
  B=2, S=1024: 0.0273 ms, 4306.1 GB/s, 53.8% peak
  B=2, S=2048: 0.0677 ms, 3469.1 GB/s, 43.4% peak
  B=4, S=128: 0.0081 ms, 3630.7 GB/s, 45.4% peak
  B=4, S=256: 0.0143 ms, 4100.2 GB/s, 51.3% peak
  B=4, S=512: 0.0270 ms, 4350.8 GB/s, 54.4% peak
  B=4, S=1024: 0.0679 ms, 3459.4 GB/s, 43.2% peak
  B=4, S=2048: 0.1309 ms, 3587.5 GB/s, 44.8% peak
  B=8, S=128: 0.0143 ms, 4109.5 GB/s, 51.4% peak
  B=8, S=256: 0.0273 ms, 4299.2 GB/s, 53.7% peak
  B=8, S=512: 0.0675 ms, 3480.2 GB/s, 43.5% peak
  B=8, S=1024: 0.1321 ms, 3555.4 GB/s, 44.4% peak
  B=8, S=2048: 0.2598 ms, 3616.1 GB/s, 45.2% peak
Saved ../results/fused_add_rmsnorm.csv

[OK] fused_add_rmsnorm completed successfully

======================================================================
Running: cutlass_scaled_fp4_mm (GEMM, Compute)
======================================================================
============================================================
Benchmark: cutlass_scaled_fp4_mm (Kernel #3)
============================================================

=== Decode Phase ===
  q_b_proj B=1: 0.0064 ms, 11810.0 GFLOPS, 0.13% peak
  kv_b_proj B=1: 0.0050 ms, 6690.4 GFLOPS, 0.07% peak
  o_proj B=1: 0.0233 ms, 10073.6 GFLOPS, 0.11% peak
  q_b_proj B=2: 0.0064 ms, 23595.3 GFLOPS, 0.26% peak
  kv_b_proj B=2: 0.0050 ms, 13318.6 GFLOPS, 0.15% peak
  o_proj B=2: 0.0234 ms, 20074.3 GFLOPS, 0.22% peak
  q_b_proj B=4: 0.0063 ms, 48000.0 GFLOPS, 0.53% peak
  kv_b_proj B=4: 0.0050 ms, 26679.6 GFLOPS, 0.30% peak
  o_proj B=4: 0.0233 ms, 40357.1 GFLOPS, 0.45% peak
  q_b_proj B=8: 0.0063 ms, 96306.3 GFLOPS, 1.07% peak
  kv_b_proj B=8: 0.0050 ms, 53337.2 GFLOPS, 0.59% peak
  o_proj B=8: 0.0234 ms, 80150.3 GFLOPS, 0.89% peak
  q_b_proj B=16: 0.0063 ms, 192046.4 GFLOPS, 2.13% peak
  kv_b_proj B=16: 0.0050 ms, 107362.6 GFLOPS, 1.19% peak
  o_proj B=16: 0.0233 ms, 161301.8 GFLOPS, 1.79% peak
  q_b_proj B=32: 0.0063 ms, 383383.1 GFLOPS, 4.26% peak
  kv_b_proj B=32: 0.0051 ms, 211470.6 GFLOPS, 2.35% peak
  o_proj B=32: 0.0234 ms, 321017.7 GFLOPS, 3.57% peak
  q_b_proj B=64: 0.0064 ms, 759445.3 GFLOPS, 8.44% peak
  kv_b_proj B=64: 0.0051 ms, 424368.8 GFLOPS, 4.72% peak
  o_proj B=64: 0.0234 ms, 642375.1 GFLOPS, 7.14% peak
  q_b_proj B=128: 0.0068 ms, 1421929.2 GFLOPS, 15.80% peak
  kv_b_proj B=128: 0.0054 ms, 796273.0 GFLOPS, 8.85% peak
  o_proj B=128: 0.0239 ms, 1256892.4 GFLOPS, 13.97% peak

=== Prefill Phase ===
  q_b_proj B=1, S=128: 0.0068 ms, 1420875.6 GFLOPS, 15.79% peak
  kv_b_proj B=1, S=128: 0.0054 ms, 795540.8 GFLOPS, 8.84% peak
  o_proj B=1, S=128: 0.0239 ms, 1256848.4 GFLOPS, 13.96% peak
  q_b_proj B=1, S=256: 0.0092 ms, 2110666.3 GFLOPS, 23.45% peak
  kv_b_proj B=1, S=256: 0.0070 ms, 1224948.8 GFLOPS, 13.61% peak
  o_proj B=1, S=256: 0.0221 ms, 2720023.2 GFLOPS, 30.22% peak
  q_b_proj B=1, S=512: 0.0125 ms, 3080847.9 GFLOPS, 34.23% peak
  kv_b_proj B=1, S=512: 0.0102 ms, 1689411.2 GFLOPS, 18.77% peak
  o_proj B=1, S=512: 0.0239 ms, 5033029.3 GFLOPS, 55.92% peak
  q_b_proj B=1, S=1024: 0.0200 ms, 3869984.9 GFLOPS, 43.00% peak
  kv_b_proj B=1, S=1024: 0.0156 ms, 2203545.8 GFLOPS, 24.48% peak
  o_proj B=1, S=1024: 0.0503 ms, 4779583.2 GFLOPS, 53.11% peak
  q_b_proj B=1, S=2048: 0.0400 ms, 3863570.3 GFLOPS, 42.93% peak
  kv_b_proj B=1, S=2048: 0.0287 ms, 2393015.2 GFLOPS, 26.59% peak
  o_proj B=1, S=2048: 0.0910 ms, 5284886.0 GFLOPS, 58.72% peak
  q_b_proj B=2, S=128: 0.0091 ms, 2113175.7 GFLOPS, 23.48% peak
  kv_b_proj B=2, S=128: 0.0071 ms, 1205981.1 GFLOPS, 13.40% peak
  o_proj B=2, S=128: 0.0233 ms, 2577628.1 GFLOPS, 28.64% peak
  q_b_proj B=2, S=256: 0.0124 ms, 3106757.8 GFLOPS, 34.52% peak
  kv_b_proj B=2, S=256: 0.0102 ms, 1687986.0 GFLOPS, 18.76% peak
  o_proj B=2, S=256: 0.0249 ms, 4836706.3 GFLOPS, 53.74% peak
  q_b_proj B=2, S=512: 0.0200 ms, 3870979.0 GFLOPS, 43.01% peak
  kv_b_proj B=2, S=512: 0.0155 ms, 2223115.6 GFLOPS, 24.70% peak
  o_proj B=2, S=512: 0.0499 ms, 4816284.1 GFLOPS, 53.51% peak
  q_b_proj B=2, S=1024: 0.0401 ms, 3858387.2 GFLOPS, 42.87% peak
  kv_b_proj B=2, S=1024: 0.0282 ms, 2435545.6 GFLOPS, 27.06% peak
  o_proj B=2, S=1024: 0.0949 ms, 5069240.6 GFLOPS, 56.32% peak
  q_b_proj B=2, S=2048: 0.0750 ms, 4125628.8 GFLOPS, 45.84% peak
  kv_b_proj B=2, S=2048: 0.0532 ms, 2583212.6 GFLOPS, 28.70% peak
  o_proj B=2, S=2048: 0.1831 ms, 5252932.1 GFLOPS, 58.37% peak
  q_b_proj B=4, S=128: 0.0127 ms, 3054738.8 GFLOPS, 33.94% peak
  kv_b_proj B=4, S=128: 0.0102 ms, 1684031.2 GFLOPS, 18.71% peak
  o_proj B=4, S=128: 0.0241 ms, 4989411.1 GFLOPS, 55.44% peak
  q_b_proj B=4, S=256: 0.0200 ms, 3870217.4 GFLOPS, 43.00% peak
  kv_b_proj B=4, S=256: 0.0152 ms, 2258716.1 GFLOPS, 25.10% peak
  o_proj B=4, S=256: 0.0505 ms, 4759766.9 GFLOPS, 52.89% peak
  q_b_proj B=4, S=512: 0.0405 ms, 3819382.0 GFLOPS, 42.44% peak
  kv_b_proj B=4, S=512: 0.0282 ms, 2436452.3 GFLOPS, 27.07% peak
  o_proj B=4, S=512: 0.0936 ms, 5141500.5 GFLOPS, 57.13% peak
  q_b_proj B=4, S=1024: 0.0747 ms, 4138512.8 GFLOPS, 45.98% peak
  kv_b_proj B=4, S=1024: 0.0524 ms, 2623292.3 GFLOPS, 29.15% peak
  o_proj B=4, S=1024: 0.1839 ms, 5232470.8 GFLOPS, 58.14% peak
  q_b_proj B=4, S=2048: 0.1467 ms, 4215165.6 GFLOPS, 46.84% peak
  kv_b_proj B=4, S=2048: 0.1013 ms, 2712457.1 GFLOPS, 30.14% peak
  o_proj B=4, S=2048: 0.3606 ms, 5336166.7 GFLOPS, 59.29% peak
  q_b_proj B=8, S=128: 0.0203 ms, 3809229.7 GFLOPS, 42.32% peak
  kv_b_proj B=8, S=128: 0.0153 ms, 2252213.2 GFLOPS, 25.02% peak
  o_proj B=8, S=128: 0.0506 ms, 4757171.4 GFLOPS, 52.86% peak
  q_b_proj B=8, S=256: 0.0404 ms, 3831715.2 GFLOPS, 42.57% peak
  kv_b_proj B=8, S=256: 0.0284 ms, 2416593.4 GFLOPS, 26.85% peak
  o_proj B=8, S=256: 0.0945 ms, 5089547.4 GFLOPS, 56.55% peak
  q_b_proj B=8, S=512: 0.0756 ms, 4088358.5 GFLOPS, 45.43% peak
  kv_b_proj B=8, S=512: 0.0537 ms, 2561713.4 GFLOPS, 28.46% peak
  o_proj B=8, S=512: 0.1839 ms, 5232804.0 GFLOPS, 58.14% peak
  q_b_proj B=8, S=1024: 0.1467 ms, 4215719.9 GFLOPS, 46.84% peak
  kv_b_proj B=8, S=1024: 0.1022 ms, 2688341.2 GFLOPS, 29.87% peak
  o_proj B=8, S=1024: 0.3627 ms, 5305345.8 GFLOPS, 58.95% peak
  q_b_proj B=8, S=2048: 0.2970 ms, 4164990.9 GFLOPS, 46.28% peak
  kv_b_proj B=8, S=2048: 0.2051 ms, 2680650.6 GFLOPS, 29.79% peak
  o_proj B=8, S=2048: 0.7262 ms, 5299143.6 GFLOPS, 58.88% peak
Saved ../results/cutlass_scaled_fp4_mm.csv

[OK] cutlass_scaled_fp4_mm completed successfully

======================================================================
Running: dsv3_fused_a_gemm (GEMM, Compute)
======================================================================
============================================================
Benchmark: dsv3_fused_a_gemm (Kernel #4)
============================================================

=== Decode Phase (B<=16, low-latency path) ===
  B=1: 0.0051 ms, 5945.7 GFLOPS, 0.26% peak
  B=2: 0.0051 ms, 11903.5 GFLOPS, 0.53% peak
  B=4: 0.0051 ms, 23683.6 GFLOPS, 1.05% peak
  B=8: 0.0052 ms, 46818.9 GFLOPS, 2.08% peak
  B=16: 0.0058 ms, 83622.5 GFLOPS, 3.72% peak
Saved ../results/dsv3_fused_a_gemm.csv

[OK] dsv3_fused_a_gemm completed successfully

======================================================================
Running: dsv3_router_gemm (GEMM, Compute)
======================================================================
============================================================
Benchmark: dsv3_router_gemm (Kernel #5)
============================================================

=== Decode Phase ===
  B=1: 0.0020 ms, 1872.0 GFLOPS, 0.08% peak
  B=2: 0.0022 ms, 3352.7 GFLOPS, 0.15% peak
  B=4: 0.0027 ms, 5436.2 GFLOPS, 0.24% peak
  B=8: 0.0036 ms, 8199.1 GFLOPS, 0.36% peak
  B=16: 0.0071 ms, 8246.6 GFLOPS, 0.37% peak
  Skipping B=32: kernel limited to num_tokens <= 16
  Skipping B=64: kernel limited to num_tokens <= 16
  Skipping B=128: kernel limited to num_tokens <= 16

=== Prefill Phase (skipped - kernel limited to 16 tokens) ===
Saved ../results/dsv3_router_gemm.csv

[OK] dsv3_router_gemm completed successfully

======================================================================
Running: bmm_fp8 (BMM, Compute)
======================================================================
============================================================
Benchmark: bmm_fp8 (Kernel #6)
============================================================

=== Decode Phase: q_nope * w_kc ===
  B=1: 0.0055 ms, 3057.0 GFLOPS, 0.07% peak
  B=2: 0.0055 ms, 6100.6 GFLOPS, 0.14% peak
  B=4: 0.0055 ms, 12202.5 GFLOPS, 0.27% peak
  B=8: 0.0055 ms, 24372.7 GFLOPS, 0.54% peak
  B=16: 0.0056 ms, 47598.8 GFLOPS, 1.06% peak
  B=32: 0.0057 ms, 93548.8 GFLOPS, 2.08% peak
  B=64: 0.0061 ms, 175772.6 GFLOPS, 3.91% peak
  B=128: 0.0069 ms, 309014.6 GFLOPS, 6.87% peak

=== Decode Phase: attn * w_vc ===
  B=1: 0.0028 ms, 6100.4 GFLOPS, 0.14% peak
  B=2: 0.0027 ms, 12239.3 GFLOPS, 0.27% peak
  B=4: 0.0027 ms, 24440.2 GFLOPS, 0.54% peak
  B=8: 0.0028 ms, 48789.3 GFLOPS, 1.08% peak
  B=16: 0.0031 ms, 85759.5 GFLOPS, 1.91% peak
  B=32: 0.0032 ms, 168430.3 GFLOPS, 3.74% peak
  B=64: 0.0033 ms, 320976.9 GFLOPS, 7.13% peak
  B=128: 0.0037 ms, 577850.2 GFLOPS, 12.84% peak
Saved ../results/bmm_fp8.csv

[OK] bmm_fp8 completed successfully

======================================================================
Running: cutlass_mla_decode (Attention, Mixed)
======================================================================
============================================================
Benchmark: cutlass_mla_decode (Kernel #7)
============================================================

=== Decode Phase (MLA Attention) ===
  B=1, seq_len=128: 0.0183 ms, 16.1 GB/s, memory
  B=1, seq_len=256: 0.0307 ms, 14.4 GB/s, memory
  B=1, seq_len=512: 0.0309 ms, 23.9 GB/s, memory
  B=1, seq_len=1024: 0.0315 ms, 42.2 GB/s, memory
  Skipping B=1, seq_len=2048: B*seq_len=2048 > 1024 (crash risk)
  B=2, seq_len=128: 0.0186 ms, 31.7 GB/s, memory
  B=2, seq_len=256: 0.0306 ms, 28.9 GB/s, memory
  B=2, seq_len=512: 0.0309 ms, 47.8 GB/s, memory
  Skipping B=2, seq_len=1024: B*seq_len=2048 > 1024 (crash risk)
  Skipping B=2, seq_len=2048: B*seq_len=4096 > 1024 (crash risk)
  B=4, seq_len=128: 0.0187 ms, 63.2 GB/s, memory
  B=4, seq_len=256: 0.0297 ms, 59.5 GB/s, memory
  Skipping B=4, seq_len=512: B*seq_len=2048 > 1024 (crash risk)
  Skipping B=4, seq_len=1024: B*seq_len=4096 > 1024 (crash risk)
  Skipping B=4, seq_len=2048: B*seq_len=8192 > 1024 (crash risk)
  B=8, seq_len=128: 0.0187 ms, 126.5 GB/s, memory
  Skipping B=8, seq_len=256: B*seq_len=2048 > 1024 (crash risk)
  Skipping B=8, seq_len=512: B*seq_len=4096 > 1024 (crash risk)
  Skipping B=8, seq_len=1024: B*seq_len=8192 > 1024 (crash risk)
  Skipping B=8, seq_len=2048: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=16, seq_len=128: B*seq_len=2048 > 1024 (crash risk)
  Skipping B=16, seq_len=256: B*seq_len=4096 > 1024 (crash risk)
  Skipping B=16, seq_len=512: B*seq_len=8192 > 1024 (crash risk)
  Skipping B=16, seq_len=1024: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=16, seq_len=2048: B*seq_len=32768 > 1024 (crash risk)
  Skipping B=32, seq_len=128: B*seq_len=4096 > 1024 (crash risk)
  Skipping B=32, seq_len=256: B*seq_len=8192 > 1024 (crash risk)
  Skipping B=32, seq_len=512: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=32, seq_len=1024: B*seq_len=32768 > 1024 (crash risk)
  Skipping B=32, seq_len=2048: B*seq_len=65536 > 1024 (crash risk)
  Skipping B=64, seq_len=128: B*seq_len=8192 > 1024 (crash risk)
  Skipping B=64, seq_len=256: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=64, seq_len=512: B*seq_len=32768 > 1024 (crash risk)
  Skipping B=64, seq_len=1024: B*seq_len=65536 > 1024 (crash risk)
  Skipping B=64, seq_len=2048: B*seq_len=131072 > 1024 (crash risk)
  Skipping B=128, seq_len=128: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=128, seq_len=256: B*seq_len=32768 > 1024 (crash risk)
  Skipping B=128, seq_len=512: B*seq_len=65536 > 1024 (crash risk)
  Skipping B=128, seq_len=1024: B*seq_len=131072 > 1024 (crash risk)
  Skipping B=128, seq_len=2048: B*seq_len=262144 > 1024 (crash risk)
Saved ../results/cutlass_mla_decode.csv

[OK] cutlass_mla_decode completed successfully

======================================================================
Running: trtllm_batch_decode_with_kv_cache_mla (Attention, Mixed)
======================================================================
============================================================
Benchmark: trtllm_batch_decode_with_kv_cache_mla (Kernel #8)
============================================================

=== Decode Phase (TRT-LLM MLA Attention) ===

  Page size: 32
    B=1, seq_len=128: 0.0056 ms, 53.1 GB/s, memory
    B=1, seq_len=256: 0.0055 ms, 80.4 GB/s, memory
    B=1, seq_len=512: 0.0074 ms, 99.5 GB/s, memory
    B=1, seq_len=1024: 0.0099 ms, 133.4 GB/s, memory
    B=1, seq_len=2048: 0.0113 ms, 221.0 GB/s, memory
    B=2, seq_len=128: 0.0059 ms, 100.2 GB/s, memory
    B=2, seq_len=256: 0.0060 ms, 147.5 GB/s, memory
    B=2, seq_len=512: 0.0081 ms, 182.2 GB/s, memory
    B=2, seq_len=1024: 0.0102 ms, 259.7 GB/s, memory
    B=2, seq_len=2048: 0.0127 ms, 395.2 GB/s, memory
    B=4, seq_len=128: 0.0068 ms, 172.3 GB/s, memory
    B=4, seq_len=256: 0.0068 ms, 259.4 GB/s, memory
    B=4, seq_len=512: 0.0090 ms, 327.0 GB/s, memory
    B=4, seq_len=1024: 0.0116 ms, 458.5 GB/s, memory
    B=4, seq_len=2048: 0.0162 ms, 618.1 GB/s, memory
    B=8, seq_len=128: 0.0076 ms, 311.4 GB/s, memory
    B=8, seq_len=256: 0.0076 ms, 467.8 GB/s, memory
    B=8, seq_len=512: 0.0104 ms, 567.5 GB/s, memory
    B=8, seq_len=1024: 0.0155 ms, 682.8 GB/s, memory
    B=8, seq_len=2048: 0.0233 ms, 859.0 GB/s, memory
    B=16, seq_len=128: 0.0093 ms, 505.1 GB/s, memory
    B=16, seq_len=256: 0.0092 ms, 766.8 GB/s, memory
    B=16, seq_len=512: 0.0130 ms, 907.5 GB/s, memory
    B=16, seq_len=1024: 0.0201 ms, 1055.6 GB/s, memory
    B=16, seq_len=2048: 0.0158 ms, 2536.8 GB/s, memory
    B=32, seq_len=128: 0.0074 ms, 1267.3 GB/s, memory
    B=32, seq_len=256: 0.0088 ms, 1612.1 GB/s, memory
    B=32, seq_len=512: 0.0141 ms, 1673.7 GB/s, memory
    B=32, seq_len=1024: 0.0171 ms, 2487.0 GB/s, memory
    B=32, seq_len=2048: 0.0242 ms, 3308.9 GB/s, memory
    B=64, seq_len=128: 0.0081 ms, 2325.3 GB/s, memory
    B=64, seq_len=256: 0.0100 ms, 2845.2 GB/s, memory
    B=64, seq_len=512: 0.0129 ms, 3665.5 GB/s, memory
    B=64, seq_len=1024: 0.0200 ms, 4251.9 GB/s, memory
    B=64, seq_len=2048: 0.0432 ms, 3709.9 GB/s, memory
    B=128, seq_len=128: 0.0127 ms, 2979.5 GB/s, memory
    B=128, seq_len=256: 0.0172 ms, 3288.9 GB/s, memory
    B=128, seq_len=512: 0.0250 ms, 3768.0 GB/s, memory
    B=128, seq_len=1024: 0.0459 ms, 3699.8 GB/s, memory
    B=128, seq_len=2048: 0.0845 ms, 3796.0 GB/s, memory

  Page size: 64
    B=1, seq_len=128: 0.0055 ms, 53.7 GB/s, memory
    B=1, seq_len=256: 0.0055 ms, 81.0 GB/s, memory
    B=1, seq_len=512: 0.0075 ms, 98.9 GB/s, memory
    B=1, seq_len=1024: 0.0099 ms, 133.6 GB/s, memory
    B=1, seq_len=2048: 0.0109 ms, 229.4 GB/s, memory
    B=2, seq_len=128: 0.0059 ms, 99.9 GB/s, memory
    B=2, seq_len=256: 0.0056 ms, 157.9 GB/s, memory
    B=2, seq_len=512: 0.0076 ms, 194.0 GB/s, memory
    B=2, seq_len=1024: 0.0097 ms, 274.2 GB/s, memory
    B=2, seq_len=2048: 0.0114 ms, 440.1 GB/s, memory
    B=4, seq_len=128: 0.0064 ms, 184.3 GB/s, memory
    B=4, seq_len=256: 0.0063 ms, 280.4 GB/s, memory
    B=4, seq_len=512: 0.0083 ms, 355.8 GB/s, memory
    B=4, seq_len=1024: 0.0109 ms, 487.3 GB/s, memory
    B=4, seq_len=2048: 0.0144 ms, 697.8 GB/s, memory
    B=8, seq_len=128: 0.0070 ms, 335.8 GB/s, memory
    B=8, seq_len=256: 0.0068 ms, 517.0 GB/s, memory
    B=8, seq_len=512: 0.0094 ms, 624.2 GB/s, memory
    B=8, seq_len=1024: 0.0135 ms, 783.7 GB/s, memory
    B=8, seq_len=2048: 0.0203 ms, 990.1 GB/s, memory
    B=16, seq_len=128: 0.0081 ms, 581.4 GB/s, memory
    B=16, seq_len=256: 0.0081 ms, 871.6 GB/s, memory
    B=16, seq_len=512: 0.0116 ms, 1017.3 GB/s, memory
    B=16, seq_len=1024: 0.0185 ms, 1148.5 GB/s, memory
    B=16, seq_len=2048: 0.0154 ms, 2601.7 GB/s, memory
    B=32, seq_len=128: 0.0072 ms, 1311.9 GB/s, memory
    B=32, seq_len=256: 0.0084 ms, 1679.6 GB/s, memory
    B=32, seq_len=512: 0.0140 ms, 1680.2 GB/s, memory
    B=32, seq_len=1024: 0.0170 ms, 2499.2 GB/s, memory
    B=32, seq_len=2048: 0.0243 ms, 3302.4 GB/s, memory
    B=64, seq_len=128: 0.0081 ms, 2325.9 GB/s, memory
    B=64, seq_len=256: 0.0098 ms, 2889.4 GB/s, memory
    B=64, seq_len=512: 0.0126 ms, 3757.2 GB/s, memory
    B=64, seq_len=1024: 0.0189 ms, 4495.6 GB/s, memory
    B=64, seq_len=2048: 0.0442 ms, 3633.0 GB/s, memory
    B=128, seq_len=128: 0.0125 ms, 3024.7 GB/s, memory
    B=128, seq_len=256: 0.0170 ms, 3337.1 GB/s, memory
    B=128, seq_len=512: 0.0240 ms, 3932.8 GB/s, memory
    B=128, seq_len=1024: 0.0482 ms, 3526.1 GB/s, memory
    B=128, seq_len=2048: 0.0848 ms, 3781.7 GB/s, memory
Saved ../results/trtllm_batch_decode_with_kv_cache_mla.csv

[OK] trtllm_batch_decode_with_kv_cache_mla completed successfully

======================================================================
Running: trtllm_ragged_attention_deepseek (Attention, Mixed)
======================================================================
============================================================
Benchmark: trtllm_ragged_attention_deepseek (Kernel #9)
============================================================

=== Prefill Phase (TRT-LLM Ragged Attention) ===
  B=1, S=128: 0.0072 ms, 737.2 GFLOPS, memory
  B=1, S=256: 0.0104 ms, 3298.3 GFLOPS, memory
  B=1, S=512: 0.0183 ms, 4816.8 GFLOPS, memory
  B=1, S=1024: 0.0355 ms, 7656.1 GFLOPS, memory
  B=1, S=2048: 0.0823 ms, 11434.7 GFLOPS, memory
  B=2, S=128: 0.0117 ms, 1159.1 GFLOPS, memory
  B=2, S=256: 0.0176 ms, 4292.4 GFLOPS, memory
  B=2, S=512: 0.0366 ms, 5143.4 GFLOPS, memory
  B=2, S=1024: 0.0903 ms, 9162.5 GFLOPS, memory
  B=2, S=2048: 0.2546 ms, 13608.7 GFLOPS, memory
  B=4, S=128: 0.0195 ms, 1606.5 GFLOPS, memory
  B=4, S=256: 0.0343 ms, 3478.4 GFLOPS, memory
  B=4, S=512: 0.0755 ms, 6156.6 GFLOPS, memory
  B=4, S=1024: 0.1612 ms, 9578.4 GFLOPS, memory
  B=4, S=2048: 0.4995 ms, 13417.2 GFLOPS, memory
  B=8, S=128: 0.0358 ms, 1774.7 GFLOPS, memory
  B=8, S=256: 0.0599 ms, 3692.0 GFLOPS, memory
  B=8, S=512: 0.1386 ms, 5929.9 GFLOPS, memory
  B=8, S=1024: 0.3467 ms, 9129.5 GFLOPS, memory
  B=8, S=2048: 0.9998 ms, 13565.3 GFLOPS, memory
  B=16, S=128: 0.0672 ms, 1710.4 GFLOPS, memory
  B=16, S=256: 0.1167 ms, 3750.0 GFLOPS, memory
  B=16, S=512: 0.2809 ms, 6076.6 GFLOPS, memory
  B=16, S=1024: 0.7346 ms, 9577.2 GFLOPS, memory
  B=16, S=2048: 2.0589 ms, 13874.3 GFLOPS, memory
  B=32, S=128: 0.1309 ms, 1674.9 GFLOPS, memory
  B=32, S=256: 0.2341 ms, 3808.1 GFLOPS, memory
  B=32, S=512: 0.5763 ms, 6369.8 GFLOPS, memory
  B=32, S=1024: 1.4690 ms, 9930.8 GFLOPS, memory
  B=32, S=2048: 4.2639 ms, 14215.7 GFLOPS, memory
  B=64, S=128: 0.2557 ms, 1694.3 GFLOPS, memory
  B=64, S=256: 0.4591 ms, 3660.0 GFLOPS, memory
  B=64, S=512: 1.1481 ms, 6276.3 GFLOPS, memory
  B=64, S=1024: 2.9640 ms, 9957.4 GFLOPS, memory
  B=64, S=2048: 8.2055 ms, 14112.0 GFLOPS, memory
  B=128, S=128: 0.5132 ms, 1747.2 GFLOPS, memory
  B=128, S=256: 0.9337 ms, 3662.4 GFLOPS, memory
  B=128, S=512: 2.2591 ms, 6201.4 GFLOPS, memory
  B=128, S=1024: 5.6092 ms, 10003.4 GFLOPS, memory
Warning: Kernel failed for B=128, S=2048: Error in function 'aligned_alloc' at /usr/local/lib/python3.12/dist-packages/flashinfer/data/include/flashinfer/allocator.h:49: Buffer overflow when allocating memory for trtllm_gen_softmax_workspace with size 200737792 and alignment 16, but only 125829120 bytes available in AlignedAllocator. Increase the workspace buffer size.
Saved ../results/trtllm_ragged_attention_deepseek.csv

[OK] trtllm_ragged_attention_deepseek completed successfully

======================================================================
Running: mla_rope_quantize_fp8 (Attention, Memory)
======================================================================
============================================================
Benchmark: rope_quantize_fp8 (MLA config) (Kernel #10)
MLA: 128 Q heads, 1 K head, 64 rope_dim + 512 no_rope_dim
============================================================

=== MLA RoPE + FP8 Quantization ===
  tokens=128: 0.0064 ms, 4627.0 GB/s, 57.8% peak
  tokens=256: 0.0114 ms, 5090.9 GB/s, 63.6% peak
  tokens=512: 0.0239 ms, 4812.4 GB/s, 60.2% peak
  tokens=1024: 0.0466 ms, 4915.6 GB/s, 61.4% peak
  tokens=2048: 0.0918 ms, 4982.0 GB/s, 62.3% peak
  tokens=4096: 0.1831 ms, 4992.4 GB/s, 62.4% peak
  tokens=8192: 0.3694 ms, 4949.2 GB/s, 61.9% peak
  tokens=16384: 0.7511 ms, 4868.2 GB/s, 60.9% peak
  tokens=32768: 1.5462 ms, 4729.5 GB/s, 59.1% peak
  tokens=65536: 3.0858 ms, 4739.6 GB/s, 59.2% peak
  tokens=131072: 6.1697 ms, 4741.1 GB/s, 59.3% peak
  tokens=262144: 13.9747 ms, 4186.3 GB/s, 52.3% peak
Saved ../results/mla_rope_quantize_fp8.csv

[OK] mla_rope_quantize_fp8 completed successfully

======================================================================
Running: apply_rope_with_cos_sin_cache_inplace (RoPE, Memory)
======================================================================
============================================================
Benchmark: apply_rope_with_cos_sin_cache_inplace (Kernel #11)
============================================================

=== Decode Phase ===
  B=1: 0.0017 ms, 350.2 GB/s, 4.4% peak
  B=2: 0.0017 ms, 385.9 GB/s, 4.8% peak
  B=4: 0.0017 ms, 460.6 GB/s, 5.8% peak
  B=8: 0.0017 ms, 603.8 GB/s, 7.5% peak
  B=16: 0.0018 ms, 893.4 GB/s, 11.2% peak
  B=32: 0.0019 ms, 1405.6 GB/s, 17.6% peak
  B=64: 0.0022 ms, 2175.2 GB/s, 27.2% peak
  B=128: 0.0033 ms, 2724.8 GB/s, 34.1% peak

=== Prefill Phase ===
  B=1, S=128: 0.0033 ms, 2738.6 GB/s, 34.2% peak
  B=1, S=256: 0.0046 ms, 3751.1 GB/s, 46.9% peak
  B=1, S=512: 0.0073 ms, 4666.8 GB/s, 58.3% peak
  B=1, S=1024: 0.0128 ms, 5282.4 GB/s, 66.0% peak
  B=1, S=2048: 0.0243 ms, 5550.1 GB/s, 69.4% peak
  B=2, S=128: 0.0046 ms, 3732.3 GB/s, 46.7% peak
  B=2, S=256: 0.0073 ms, 4660.9 GB/s, 58.3% peak
  B=2, S=512: 0.0128 ms, 5286.8 GB/s, 66.1% peak
  B=2, S=1024: 0.0242 ms, 5565.5 GB/s, 69.6% peak
  B=2, S=2048: 0.0677 ms, 3972.5 GB/s, 49.7% peak
  B=4, S=128: 0.0073 ms, 4658.1 GB/s, 58.2% peak
  B=4, S=256: 0.0127 ms, 5316.1 GB/s, 66.5% peak
  B=4, S=512: 0.0241 ms, 5580.4 GB/s, 69.8% peak
  B=4, S=1024: 0.0672 ms, 4000.5 GB/s, 50.0% peak
  B=4, S=2048: 0.1390 ms, 3867.0 GB/s, 48.3% peak
  B=8, S=128: 0.0127 ms, 5328.4 GB/s, 66.6% peak
  B=8, S=256: 0.0239 ms, 5633.0 GB/s, 70.4% peak
  B=8, S=512: 0.0671 ms, 4008.3 GB/s, 50.1% peak
  B=8, S=1024: 0.1373 ms, 3914.1 GB/s, 48.9% peak
  B=8, S=2048: 0.2877 ms, 3734.6 GB/s, 46.7% peak
Saved ../results/apply_rope_with_cos_sin_cache_inplace.csv

[OK] apply_rope_with_cos_sin_cache_inplace completed successfully

======================================================================
Running: concat_mla_k (Concat, Memory)
======================================================================
============================================================
Benchmark: concat_mla_k (Kernel #12)
============================================================

=== Decode Phase ===
  B=1: 0.0021 ms, 38.9 GB/s, 0.5% peak
  B=2: 0.0030 ms, 54.4 GB/s, 0.7% peak
  B=4: 0.0048 ms, 68.2 GB/s, 0.9% peak
  B=8: 0.0048 ms, 135.7 GB/s, 1.7% peak
  B=16: 0.0049 ms, 270.3 GB/s, 3.4% peak
  B=32: 0.0048 ms, 542.2 GB/s, 6.8% peak
  B=64: 0.0049 ms, 1076.6 GB/s, 13.5% peak
  B=128: 0.0049 ms, 2149.9 GB/s, 26.9% peak

=== Prefill Phase ===
  B=1, S=128: 0.0049 ms, 2149.8 GB/s, 26.9% peak
  B=1, S=256: 0.0050 ms, 4231.9 GB/s, 52.9% peak
  B=1, S=512: 0.0055 ms, 7671.0 GB/s, 95.9% peak
  B=1, S=1024: 0.0106 ms, 7928.4 GB/s, 99.1% peak
  B=1, S=2048: 0.0273 ms, 6146.9 GB/s, 76.8% peak
  B=2, S=128: 0.0050 ms, 4195.7 GB/s, 52.4% peak
  B=2, S=256: 0.0051 ms, 8304.3 GB/s, 103.8% peak
  B=2, S=512: 0.0095 ms, 8828.7 GB/s, 110.4% peak
  B=2, S=1024: 0.0273 ms, 6145.5 GB/s, 76.8% peak
  B=2, S=2048: 0.0520 ms, 6459.6 GB/s, 80.7% peak
  B=4, S=128: 0.0051 ms, 8279.5 GB/s, 103.5% peak
  B=4, S=256: 0.0095 ms, 8888.3 GB/s, 111.1% peak
  B=4, S=512: 0.0272 ms, 6186.8 GB/s, 77.3% peak
  B=4, S=1024: 0.0522 ms, 6443.0 GB/s, 80.5% peak
  B=4, S=2048: 0.1008 ms, 6666.6 GB/s, 83.3% peak
  B=8, S=128: 0.0096 ms, 8752.2 GB/s, 109.4% peak
  B=8, S=256: 0.0271 ms, 6195.6 GB/s, 77.4% peak
  B=8, S=512: 0.0524 ms, 6416.1 GB/s, 80.2% peak
  B=8, S=1024: 0.1008 ms, 6669.1 GB/s, 83.4% peak
  B=8, S=2048: 0.1982 ms, 6782.0 GB/s, 84.8% peak
Saved ../results/concat_mla_k.csv

[OK] concat_mla_k completed successfully

======================================================================
Running: silu_and_mul (Activation, Memory)
======================================================================
============================================================
Benchmark: silu_and_mul (Kernel #13)
============================================================

=== Decode Phase ===
  B=1: 0.0018 ms, 6.8 GB/s, 0.1% peak
  B=2: 0.0018 ms, 13.6 GB/s, 0.2% peak
  B=4: 0.0018 ms, 27.2 GB/s, 0.3% peak
  B=8: 0.0018 ms, 54.4 GB/s, 0.7% peak
  B=16: 0.0019 ms, 105.5 GB/s, 1.3% peak
  B=32: 0.0019 ms, 210.6 GB/s, 2.6% peak
  B=64: 0.0019 ms, 415.6 GB/s, 5.2% peak
  B=128: 0.0019 ms, 814.4 GB/s, 10.2% peak

=== Prefill Phase ===
  B=1, S=128: 0.0019 ms, 814.4 GB/s, 10.2% peak
  B=1, S=256: 0.0021 ms, 1480.5 GB/s, 18.5% peak
  B=1, S=512: 0.0028 ms, 2258.3 GB/s, 28.2% peak
  B=1, S=1024: 0.0038 ms, 3300.2 GB/s, 41.3% peak
  B=1, S=2048: 0.0058 ms, 4358.5 GB/s, 54.5% peak
  B=2, S=128: 0.0021 ms, 1479.0 GB/s, 18.5% peak
  B=2, S=256: 0.0028 ms, 2257.4 GB/s, 28.2% peak
  B=2, S=512: 0.0038 ms, 3301.4 GB/s, 41.3% peak
  B=2, S=1024: 0.0058 ms, 4361.9 GB/s, 54.5% peak
  B=2, S=2048: 0.0098 ms, 5121.2 GB/s, 64.0% peak
  B=4, S=128: 0.0028 ms, 2224.5 GB/s, 27.8% peak
  B=4, S=256: 0.0038 ms, 3304.1 GB/s, 41.3% peak
  B=4, S=512: 0.0058 ms, 4359.3 GB/s, 54.5% peak
  B=4, S=1024: 0.0099 ms, 5108.1 GB/s, 63.9% peak
  B=4, S=2048: 0.0204 ms, 4942.0 GB/s, 61.8% peak
  B=8, S=128: 0.0038 ms, 3291.0 GB/s, 41.1% peak
  B=8, S=256: 0.0058 ms, 4355.3 GB/s, 54.4% peak
  B=8, S=512: 0.0099 ms, 5100.1 GB/s, 63.8% peak
  B=8, S=1024: 0.0200 ms, 5022.0 GB/s, 62.8% peak
  B=8, S=2048: 0.0400 ms, 5027.8 GB/s, 62.8% peak
Saved ../results/silu_and_mul.csv

[OK] silu_and_mul completed successfully

======================================================================
Running: topk_softmax (MoE Routing, Memory)
======================================================================
============================================================
Benchmark: topk_softmax (Kernel #14)
============================================================

=== Decode Phase ===
  B=1: 0.0034 ms, 0.3 GB/s, 0.0% peak
  B=2: 0.0034 ms, 0.6 GB/s, 0.0% peak
  B=4: 0.0034 ms, 1.3 GB/s, 0.0% peak
  B=8: 0.0035 ms, 2.5 GB/s, 0.0% peak
  B=16: 0.0035 ms, 5.0 GB/s, 0.1% peak
  B=32: 0.0035 ms, 10.1 GB/s, 0.1% peak
  B=64: 0.0035 ms, 19.9 GB/s, 0.2% peak
  B=128: 0.0035 ms, 39.8 GB/s, 0.5% peak

=== Prefill Phase ===
  B=1, S=128: 0.0035 ms, 39.7 GB/s, 0.5% peak
  B=1, S=256: 0.0035 ms, 78.8 GB/s, 1.0% peak
  B=1, S=512: 0.0036 ms, 156.8 GB/s, 2.0% peak
  B=1, S=1024: 0.0039 ms, 286.2 GB/s, 3.6% peak
  B=1, S=2048: 0.0053 ms, 424.3 GB/s, 5.3% peak
  B=2, S=128: 0.0035 ms, 78.8 GB/s, 1.0% peak
  B=2, S=256: 0.0036 ms, 156.8 GB/s, 2.0% peak
  B=2, S=512: 0.0039 ms, 286.3 GB/s, 3.6% peak
  B=2, S=1024: 0.0053 ms, 424.2 GB/s, 5.3% peak
  B=2, S=2048: 0.0078 ms, 574.6 GB/s, 7.2% peak
  B=4, S=128: 0.0036 ms, 156.8 GB/s, 2.0% peak
  B=4, S=256: 0.0039 ms, 286.3 GB/s, 3.6% peak
  B=4, S=512: 0.0053 ms, 424.1 GB/s, 5.3% peak
  B=4, S=1024: 0.0078 ms, 574.6 GB/s, 7.2% peak
  B=4, S=2048: 0.0132 ms, 672.8 GB/s, 8.4% peak
  B=8, S=128: 0.0039 ms, 286.2 GB/s, 3.6% peak
  B=8, S=256: 0.0053 ms, 424.3 GB/s, 5.3% peak
  B=8, S=512: 0.0078 ms, 574.7 GB/s, 7.2% peak
  B=8, S=1024: 0.0132 ms, 672.7 GB/s, 8.4% peak
  B=8, S=2048: 0.0237 ms, 753.1 GB/s, 9.4% peak
Saved ../results/topk_softmax.csv

[OK] topk_softmax completed successfully

======================================================================
Running: topk_sigmoid (MoE Routing, Memory)
======================================================================
============================================================
Benchmark: topk_sigmoid (Kernel #15)
============================================================

=== Decode Phase ===
  B=1: 0.0035 ms, 0.3 GB/s, 0.0% peak
  B=2: 0.0035 ms, 0.6 GB/s, 0.0% peak
  B=4: 0.0037 ms, 1.2 GB/s, 0.0% peak
  B=8: 0.0037 ms, 2.3 GB/s, 0.0% peak
  B=16: 0.0037 ms, 4.7 GB/s, 0.1% peak
  B=32: 0.0037 ms, 9.4 GB/s, 0.1% peak
  B=64: 0.0037 ms, 18.6 GB/s, 0.2% peak
  B=128: 0.0038 ms, 37.0 GB/s, 0.5% peak

=== Prefill Phase ===
  B=1, S=128: 0.0038 ms, 37.0 GB/s, 0.5% peak
  B=1, S=256: 0.0038 ms, 73.6 GB/s, 0.9% peak
  B=1, S=512: 0.0038 ms, 146.1 GB/s, 1.8% peak
  B=1, S=1024: 0.0041 ms, 272.9 GB/s, 3.4% peak
  B=1, S=2048: 0.0053 ms, 417.8 GB/s, 5.2% peak
  B=2, S=128: 0.0038 ms, 73.6 GB/s, 0.9% peak
  B=2, S=256: 0.0038 ms, 146.1 GB/s, 1.8% peak
  B=2, S=512: 0.0041 ms, 272.9 GB/s, 3.4% peak
  B=2, S=1024: 0.0053 ms, 417.8 GB/s, 5.2% peak
  B=2, S=2048: 0.0077 ms, 578.9 GB/s, 7.2% peak
  B=4, S=128: 0.0038 ms, 146.1 GB/s, 1.8% peak
  B=4, S=256: 0.0041 ms, 272.9 GB/s, 3.4% peak
  B=4, S=512: 0.0053 ms, 417.8 GB/s, 5.2% peak
  B=4, S=1024: 0.0077 ms, 578.8 GB/s, 7.2% peak
  B=4, S=2048: 0.0129 ms, 688.7 GB/s, 8.6% peak
  B=8, S=128: 0.0041 ms, 273.0 GB/s, 3.4% peak
  B=8, S=256: 0.0053 ms, 417.8 GB/s, 5.2% peak
  B=8, S=512: 0.0077 ms, 578.8 GB/s, 7.2% peak
  B=8, S=1024: 0.0129 ms, 688.7 GB/s, 8.6% peak
  B=8, S=2048: 0.0228 ms, 780.3 GB/s, 9.8% peak
Saved ../results/topk_sigmoid.csv

[OK] topk_sigmoid completed successfully

======================================================================
Running: moe_fused_gate (MoE Routing, Memory)
======================================================================
============================================================
Benchmark: moe_fused_gate (Kernel #16)
============================================================

=== Decode Phase ===
  B=1: 0.0109 ms, 0.2 GB/s, 0.0% peak
  B=2: 0.0111 ms, 0.3 GB/s, 0.0% peak
  B=4: 0.0114 ms, 0.5 GB/s, 0.0% peak
  B=8: 0.0121 ms, 0.8 GB/s, 0.0% peak
  B=16: 0.0135 ms, 1.4 GB/s, 0.0% peak
  B=32: 0.0155 ms, 2.3 GB/s, 0.0% peak
  B=64: 0.0158 ms, 4.5 GB/s, 0.1% peak
  B=128: 0.0158 ms, 8.9 GB/s, 0.1% peak

=== Prefill Phase ===
  B=1, S=128: 0.0158 ms, 8.9 GB/s, 0.1% peak
  B=1, S=256: 0.0158 ms, 17.7 GB/s, 0.2% peak
  B=1, S=512: 0.0158 ms, 35.3 GB/s, 0.4% peak
  B=1, S=1024: 0.0160 ms, 69.7 GB/s, 0.9% peak
  B=1, S=2048: 0.0159 ms, 139.8 GB/s, 1.7% peak
  B=2, S=128: 0.0157 ms, 17.8 GB/s, 0.2% peak
  B=2, S=256: 0.0158 ms, 35.2 GB/s, 0.4% peak
  B=2, S=512: 0.0158 ms, 70.7 GB/s, 0.9% peak
  B=2, S=1024: 0.0159 ms, 140.3 GB/s, 1.8% peak
  B=2, S=2048: 0.0217 ms, 205.6 GB/s, 2.6% peak
  B=4, S=128: 0.0156 ms, 35.7 GB/s, 0.4% peak
  B=4, S=256: 0.0158 ms, 70.5 GB/s, 0.9% peak
  B=4, S=512: 0.0160 ms, 139.7 GB/s, 1.7% peak
  B=4, S=1024: 0.0220 ms, 202.4 GB/s, 2.5% peak
  B=4, S=2048: 0.0291 ms, 306.1 GB/s, 3.8% peak
  B=8, S=128: 0.0158 ms, 70.7 GB/s, 0.9% peak
  B=8, S=256: 0.0161 ms, 138.6 GB/s, 1.7% peak
  B=8, S=512: 0.0216 ms, 205.9 GB/s, 2.6% peak
  B=8, S=1024: 0.0291 ms, 306.7 GB/s, 3.8% peak
  B=8, S=2048: 0.0455 ms, 391.9 GB/s, 4.9% peak
Saved ../results/moe_fused_gate.csv

[OK] moe_fused_gate completed successfully

======================================================================
Running: prepare_moe_input (MoE, Memory)
======================================================================
============================================================
Benchmark: prepare_moe_input (Kernel #17)
============================================================

=== Decode Phase ===
  B=1: 0.0136 ms, 0.2 GB/s, 0.0% peak
  B=2: 0.0139 ms, 0.2 GB/s, 0.0% peak
  B=4: 0.0140 ms, 0.2 GB/s, 0.0% peak
  B=8: 0.0138 ms, 0.3 GB/s, 0.0% peak
  B=16: 0.0142 ms, 0.3 GB/s, 0.0% peak
  B=32: 0.0154 ms, 0.4 GB/s, 0.0% peak
  B=64: 0.0175 ms, 0.5 GB/s, 0.0% peak
  B=128: 0.0197 ms, 0.8 GB/s, 0.0% peak

=== Prefill Phase ===
  B=1, S=128: 0.0197 ms, 0.8 GB/s, 0.0% peak
  B=1, S=256: 0.0198 ms, 1.4 GB/s, 0.0% peak
  B=1, S=512: 0.0228 ms, 2.3 GB/s, 0.0% peak
  B=1, S=1024: 0.0255 ms, 4.0 GB/s, 0.0% peak
  B=1, S=2048: 0.0293 ms, 6.8 GB/s, 0.1% peak
  B=2, S=128: 0.0200 ms, 1.4 GB/s, 0.0% peak
  B=2, S=256: 0.0221 ms, 2.4 GB/s, 0.0% peak
  B=2, S=512: 0.0256 ms, 4.0 GB/s, 0.0% peak
  B=2, S=1024: 0.0299 ms, 6.7 GB/s, 0.1% peak
  B=2, S=2048: 0.0481 ms, 8.2 GB/s, 0.1% peak
  B=4, S=128: 0.0226 ms, 2.3 GB/s, 0.0% peak
  B=4, S=256: 0.0258 ms, 3.9 GB/s, 0.0% peak
  B=4, S=512: 0.0298 ms, 6.7 GB/s, 0.1% peak
  B=4, S=1024: 0.0476 ms, 8.3 GB/s, 0.1% peak
  B=4, S=2048: 0.0744 ms, 10.6 GB/s, 0.1% peak
  B=8, S=128: 0.0263 ms, 3.9 GB/s, 0.0% peak
  B=8, S=256: 0.0306 ms, 6.5 GB/s, 0.1% peak
  B=8, S=512: 0.0481 ms, 8.2 GB/s, 0.1% peak
  B=8, S=1024: 0.0742 ms, 10.6 GB/s, 0.1% peak
  B=8, S=2048: 0.1340 ms, 11.8 GB/s, 0.1% peak
Saved ../results/prepare_moe_input.csv

[OK] prepare_moe_input completed successfully

======================================================================
Running: scaled_fp4_experts_quant (MoE, Memory)
======================================================================
============================================================
Benchmark: scaled_fp4_experts_quant (Kernel #18)
============================================================

=== Decode Phase ===
  B=1: 0.0075 ms, 19.7 GB/s, 0.2% peak
  B=2: 0.0074 ms, 40.0 GB/s, 0.5% peak
  B=4: 0.0074 ms, 79.6 GB/s, 1.0% peak
  B=8: 0.0079 ms, 148.0 GB/s, 1.8% peak
  B=16: 0.0092 ms, 256.7 GB/s, 3.2% peak
  B=32: 0.0123 ms, 383.0 GB/s, 4.8% peak
  B=64: 0.0067 ms, 1396.3 GB/s, 17.5% peak
  B=128: 0.0108 ms, 1735.1 GB/s, 21.7% peak

=== Prefill Phase ===
  B=1, S=128: 0.0108 ms, 1737.1 GB/s, 21.7% peak
Warning: Kernel failed for B=1, S=256: CUDA error: an illegal memory access was encountered
Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


Traceback (most recent call last):
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_scaled_fp4_experts_quant.py", line 173, in <module>
    main()
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_scaled_fp4_experts_quant.py", line 169, in main
    run_benchmarks(batch_sizes, seq_lens, args.output)
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_scaled_fp4_experts_quant.py", line 143, in run_benchmarks
    result = bench_scaled_fp4_experts_quant(sgl_kernel, B, S, H, E, K, "prefill")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_scaled_fp4_experts_quant.py", line 48, in bench_scaled_fp4_experts_quant
    expert_inputs = torch.randn(total_expert_tokens, hidden_size, dtype=torch.bfloat16, device=device)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.AcceleratorError: CUDA error: an illegal memory access was encountered
Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


[FAILED] scaled_fp4_experts_quant: Exit code 1

======================================================================
Running: cutlass_fp4_group_mm (MoE, Compute)
======================================================================
============================================================
Benchmark: cutlass_fp4_group_mm (Kernel #19)
============================================================

=== Decode Phase: gate_up ===
  B=1: 0.0472 ms, 9944.7 GFLOPS, 0.11% peak
  B=2: 0.0489 ms, 19222.2 GFLOPS, 0.21% peak
  B=4: 0.0511 ms, 36780.6 GFLOPS, 0.41% peak
  B=8: 0.0470 ms, 79961.8 GFLOPS, 0.89% peak
  B=16: 0.0536 ms, 140324.7 GFLOPS, 1.56% peak
Warning: Kernel failed for B=32, S=1, op=gate_up: CUDA error: an illegal memory access was encountered
Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


Traceback (most recent call last):
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_cutlass_fp4_group_mm.py", line 233, in <module>
    main()
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_cutlass_fp4_group_mm.py", line 229, in main
    run_benchmarks(batch_sizes, seq_lens, args.output)
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_cutlass_fp4_group_mm.py", line 179, in run_benchmarks
    result = bench_cutlass_fp4_group_mm(sgl_kernel, B, 1, E, K, H, I, "gate_up", "decode")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_cutlass_fp4_group_mm.py", line 62, in bench_cutlass_fp4_group_mm
    a = torch.randn((M, K_dim), dtype=torch.bfloat16, device=device)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.AcceleratorError: CUDA error: an illegal memory access was encountered
Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


[FAILED] cutlass_fp4_group_mm: Exit code 1

======================================================================
Running: apply_shuffle_mul_sum (MoE, Memory)
======================================================================
============================================================
Benchmark: apply_shuffle_mul_sum (Kernel #20)
============================================================

=== Decode Phase ===
  B=1: 0.0030 ms, 43.6 GB/s, 0.5% peak
  B=2: 0.0030 ms, 87.2 GB/s, 1.1% peak
  B=4: 0.0030 ms, 174.3 GB/s, 2.2% peak
  B=8: 0.0030 ms, 347.4 GB/s, 4.3% peak
  B=16: 0.0030 ms, 687.2 GB/s, 8.6% peak
  B=32: 0.0030 ms, 1367.9 GB/s, 17.1% peak
  B=64: 0.0030 ms, 2720.1 GB/s, 34.0% peak
  B=128: 0.0031 ms, 5339.0 GB/s, 66.7% peak

=== Prefill Phase ===
  B=1, S=128: 0.0031 ms, 5337.6 GB/s, 66.7% peak
  B=1, S=256: 0.0041 ms, 7971.8 GB/s, 99.6% peak
  B=1, S=512: 0.0066 ms, 9989.9 GB/s, 124.9% peak
  B=1, S=1024: 0.0105 ms, 12618.7 GB/s, 157.7% peak
  B=1, S=2048: 0.0190 ms, 13917.5 GB/s, 174.0% peak
  B=2, S=128: 0.0041 ms, 7988.1 GB/s, 99.9% peak
  B=2, S=256: 0.0066 ms, 9969.8 GB/s, 124.6% peak
  B=2, S=512: 0.0105 ms, 12586.3 GB/s, 157.3% peak
  B=2, S=1024: 0.0190 ms, 13914.5 GB/s, 173.9% peak
  B=2, S=2048: 0.0382 ms, 13842.7 GB/s, 173.0% peak
  B=4, S=128: 0.0066 ms, 9959.8 GB/s, 124.5% peak
  B=4, S=256: 0.0105 ms, 12611.7 GB/s, 157.6% peak
  B=4, S=512: 0.0190 ms, 13913.8 GB/s, 173.9% peak
  B=4, S=1024: 0.0382 ms, 13840.9 GB/s, 173.0% peak
  B=4, S=2048: 0.0736 ms, 14373.9 GB/s, 179.7% peak
  B=8, S=128: 0.0105 ms, 12591.5 GB/s, 157.4% peak
  B=8, S=256: 0.0195 ms, 13592.1 GB/s, 169.9% peak
  B=8, S=512: 0.0380 ms, 13901.1 GB/s, 173.8% peak
  B=8, S=1024: 0.0736 ms, 14374.2 GB/s, 179.7% peak
  B=8, S=2048: 0.1434 ms, 14749.0 GB/s, 184.4% peak
Saved ../results/apply_shuffle_mul_sum.csv

[OK] apply_shuffle_mul_sum completed successfully

======================================================================
Running: moe_align_block_size (MoE, Memory)
======================================================================
============================================================
Benchmark: moe_align_block_size (Kernel #21)
============================================================

=== Decode Phase ===
  B=1: 0.0043 ms, 15.7 GB/s, 0.2% peak
  B=2: 0.0043 ms, 15.7 GB/s, 0.2% peak
  B=4: 0.0043 ms, 15.6 GB/s, 0.2% peak
  B=8: 0.0043 ms, 15.7 GB/s, 0.2% peak
  B=16: 0.0044 ms, 15.6 GB/s, 0.2% peak
  B=32: 0.0043 ms, 16.2 GB/s, 0.2% peak
  B=64: 0.0043 ms, 16.7 GB/s, 0.2% peak
  B=128: 0.0045 ms, 16.9 GB/s, 0.2% peak

=== Prefill Phase ===
  B=1, S=128: 0.0045 ms, 16.9 GB/s, 0.2% peak
  B=1, S=256: 0.0048 ms, 17.7 GB/s, 0.2% peak
  B=1, S=512: 0.0056 ms, 18.1 GB/s, 0.2% peak
  B=1, S=1024: 0.0072 ms, 18.6 GB/s, 0.2% peak
  B=1, S=2048: 0.0086 ms, 23.2 GB/s, 0.3% peak
  B=2, S=128: 0.0048 ms, 17.6 GB/s, 0.2% peak
  B=2, S=256: 0.0056 ms, 18.1 GB/s, 0.2% peak
  B=2, S=512: 0.0072 ms, 18.6 GB/s, 0.2% peak
  B=2, S=1024: 0.0086 ms, 23.1 GB/s, 0.3% peak
  B=2, S=2048: 0.0136 ms, 24.5 GB/s, 0.3% peak
  B=4, S=128: 0.0056 ms, 18.1 GB/s, 0.2% peak
  B=4, S=256: 0.0072 ms, 18.5 GB/s, 0.2% peak
  B=4, S=512: 0.0086 ms, 23.2 GB/s, 0.3% peak
  B=4, S=1024: 0.0135 ms, 24.5 GB/s, 0.3% peak
  B=4, S=2048: 0.0231 ms, 25.8 GB/s, 0.3% peak
  B=8, S=128: 0.0072 ms, 18.6 GB/s, 0.2% peak
  B=8, S=256: 0.0087 ms, 23.0 GB/s, 0.3% peak
  B=8, S=512: 0.0135 ms, 24.5 GB/s, 0.3% peak
  B=8, S=1024: 0.0232 ms, 25.7 GB/s, 0.3% peak
  B=8, S=2048: 0.0422 ms, 26.7 GB/s, 0.3% peak
Saved ../results/moe_align_block_size.csv

[OK] moe_align_block_size completed successfully

======================================================================
Running: trtllm_fp4_block_scale_moe (MoE, Mixed)
======================================================================
============================================================
Benchmark: trtllm_fp4_block_scale_moe (Kernel #22)
============================================================

=== Decode Phase ===
Warning: Kernel failed for B=1, S=1: Error in function 'run' at /usr/local/lib/python3.12/dist-packages/flashinfer/data/csrc/trtllm_batched_gemm_runner.cu:258: Error occurred when running GEMM! (numBatches:  256 , GemmMNK:  1   4096   7168 , Kernel:  bmm_E2m1_E2m1E2m1_Fp32_t128x8x512u2_s5_et128x8_m128x8x64_cga1x1x1_16dp256b_rM_TN_transOut_schedP2x1x2x3_bN_ldgsts_tmaOpt_clmp_swiGlu_dynBatch_sm100f )

Traceback (most recent call last):
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_trtllm_fp4_block_scale_moe.py", line 314, in <module>
    main()
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_trtllm_fp4_block_scale_moe.py", line 310, in main
    run_benchmarks(batch_sizes, seq_lens, args.output)
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_trtllm_fp4_block_scale_moe.py", line 275, in run_benchmarks
    result = bench_trtllm_fp4_block_scale_moe(flashinfer, B, 1, H, E, K, I, "decode")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/deepseek_kernel_benchmarks/scripts/bench_trtllm_fp4_block_scale_moe.py", line 95, in bench_trtllm_fp4_block_scale_moe
    torch.manual_seed(42)
  File "/usr/local/lib/python3.12/dist-packages/torch/random.py", line 46, in manual_seed
    torch.cuda.manual_seed_all(seed)
  File "/usr/local/lib/python3.12/dist-packages/torch/cuda/random.py", line 131, in manual_seed_all
    _lazy_call(cb, seed_all=True)
  File "/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py", line 341, in _lazy_call
    callable()
  File "/usr/local/lib/python3.12/dist-packages/torch/cuda/random.py", line 129, in cb
    default_generator.manual_seed(seed)
torch.AcceleratorError: CUDA error: an illegal memory access was encountered
Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


[FAILED] trtllm_fp4_block_scale_moe: Exit code 1

======================================================================
Running: fused_moe_kernel (MoE, Mixed)
======================================================================
============================================================
Benchmark: fused_moe_kernel (Kernel #23)
============================================================

=== Decode Phase ===
  B=1: 0.1337 ms, 5269.6 GFLOPS, 2107.83% peak (memory)
  B=2: 0.2820 ms, 4997.3 GFLOPS, 999.46% peak (memory)
  B=4: 0.4507 ms, 6254.3 GFLOPS, 625.43% peak (memory)
  B=8: 0.8833 ms, 6382.0 GFLOPS, 319.10% peak (memory)
  B=16: 1.4322 ms, 7872.0 GFLOPS, 196.80% peak (memory)
  B=32: 2.2147 ms, 10181.5 GFLOPS, 127.27% peak (memory)
  B=64: 2.9023 ms, 15538.2 GFLOPS, 97.12% peak (memory)
  B=128: 3.4224 ms, 26353.9 GFLOPS, 82.37% peak (memory)

=== Prefill Phase ===
  B=1, S=128: 3.4258 ms, 26327.6 GFLOPS, 82.29% peak (memory)
  B=1, S=256: 3.5180 ms, 51275.7 GFLOPS, 80.14% peak (memory)
  B=1, S=512: 3.9025 ms, 92446.8 GFLOPS, 72.27% peak (memory)
  B=1, S=1024: 4.0826 ms, 176740.2 GFLOPS, 69.13% peak (memory)
  B=1, S=2048: 5.3925 ms, 267613.0 GFLOPS, 52.40% peak (memory)
  B=2, S=128: 3.5237 ms, 51193.0 GFLOPS, 80.02% peak (memory)
  B=2, S=256: 3.9015 ms, 92471.3 GFLOPS, 72.29% peak (memory)
  B=2, S=512: 4.0758 ms, 177031.9 GFLOPS, 69.24% peak (memory)
  B=2, S=1024: 5.3204 ms, 271239.3 GFLOPS, 53.11% peak (memory)
  B=2, S=2048: 8.2316 ms, 350626.9 GFLOPS, 34.42% peak (memory)
  B=4, S=128: 3.8996 ms, 92516.4 GFLOPS, 72.33% peak (memory)
  B=4, S=256: 4.0744 ms, 177094.7 GFLOPS, 69.27% peak (memory)
  B=4, S=512: 5.3329 ms, 270607.3 GFLOPS, 52.99% peak (memory)
  B=4, S=1024: 8.1810 ms, 352795.3 GFLOPS, 34.63% peak (memory)
  B=4, S=2048: 14.1155 ms, 408942.5 GFLOPS, 20.18% peak (memory)
  B=8, S=128: 4.0702 ms, 177275.5 GFLOPS, 69.34% peak (memory)
  B=8, S=256: 5.3128 ms, 271627.6 GFLOPS, 53.19% peak (memory)
  B=8, S=512: 8.1663 ms, 353431.5 GFLOPS, 34.69% peak (memory)
  B=8, S=1024: 13.9846 ms, 412769.7 GFLOPS, 20.36% peak (memory)
  B=8, S=2048: 32.4584 ms, 355681.8 GFLOPS, 15.81% peak (compute)
Saved ../results/fused_moe_kernel.csv

[2026-01-27 21:02:03] WARNING fused_moe_triton_config.py:127: Using default MoE kernel config. Performance might be sub-optimal! Config file not found at /lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/sglang/python/sglang/srt/layers/moe/fused_moe_triton/configs/triton_3_5_1/E=256,N=2048,device_name=NVIDIA_GB200.json, you can create them with https://github.com/sgl-project/sglang/tree/main/benchmark/kernels/fused_moe_triton
[2026-01-27 21:02:03] WARNING fused_moe_triton_config.py:119: Using MoE kernel config with down_moe=False. Performance might be sub-optimal! Config file not found at /lustre/fsw/sw_aidot/pengchengl/sglang_deepseek_only/mini-sglang-deepseek-only/sglang/python/sglang/srt/layers/moe/fused_moe_triton/configs/triton_3_5_1/E=256,N=2048,device_name=NVIDIA_GB200_down.json, you can create them with https://github.com/sgl-project/sglang/tree/main/benchmark/kernels/fused_moe_triton

[OK] fused_moe_kernel completed successfully

Aggregated results saved to ../results/all_kernels.csv
Total benchmark results: 587

Summary saved to ../results/benchmark_summary.md

======================================================================
Benchmark Complete!
Successful: 20/23
Failed kernels:
  - scaled_fp4_experts_quant: Exit code 1
  - cutlass_fp4_group_mm: Exit code 1
  - trtllm_fp4_block_scale_moe: Exit code 1
======================================================================
