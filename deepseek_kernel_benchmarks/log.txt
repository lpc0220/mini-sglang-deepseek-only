======================================================================
DeepSeek-R1-NVFP4-v2 Kernel Benchmarks
======================================================================
Kernels to run: 1
Batch sizes: 1,2,4,8,16,32,64,128
Sequence lengths: 128,256,512,1024,2048
Output directory: ../results/

NOTE: Each kernel runs in a separate subprocess for isolation.
      CUDA crashes in one kernel will NOT affect other kernels.
======================================================================

======================================================================
Running: trtllm_fp4_block_scale_moe (MoE, Mixed)
======================================================================
============================================================
Benchmark: trtllm_fp4_block_scale_moe (Kernel #22)
============================================================

Note: This kernel requires complex weight preprocessing (shuffling, permutation)
that is difficult to replicate outside flashinfer's test framework.
Using flashinfer's own benchmark infrastructure...

=== Running flashinfer benchmark ===

  decode B=8 (tokens=8):
    FAILED: usage: flashinfer_benchmark.py [-h] --routine
                               {BatchDecodeWithPagedKVCacheWrapper,BatchPrefillWithPagedKVCacheWrapper,BatchPrefillWithRaggedKVCacheWrapper,BatchMLAPagedA

  prefill B=1,S=128 (tokens=128):
    FAILED: usage: flashinfer_benchmark.py [-h] --routine
                               {BatchDecodeWithPagedKVCacheWrapper,BatchPrefillWithPagedKVCacheWrapper,BatchPrefillWithRaggedKVCacheWrapper,BatchMLAPagedA

  prefill B=1,S=256 (tokens=256):
    FAILED: usage: flashinfer_benchmark.py [-h] --routine
                               {BatchDecodeWithPagedKVCacheWrapper,BatchPrefillWithPagedKVCacheWrapper,BatchPrefillWithRaggedKVCacheWrapper,BatchMLAPagedA

  prefill B=1,S=1024 (tokens=1024):
    FAILED: usage: flashinfer_benchmark.py [-h] --routine
                               {BatchDecodeWithPagedKVCacheWrapper,BatchPrefillWithPagedKVCacheWrapper,BatchPrefillWithRaggedKVCacheWrapper,BatchMLAPagedA

============================================================
Note: This kernel benchmark uses flashinfer's internal benchmark tool.
Results may differ from other kernels due to different measurement methods.
============================================================

[FAILED] trtllm_fp4_block_scale_moe: No CSV output (kernel not available or all runs failed)

Aggregated results saved to ../results/all_kernels.csv
Total benchmark results: 606

Summary saved to ../results/benchmark_summary.md

======================================================================
Benchmark Complete!
Successful: 0/1
Failed kernels:
  - trtllm_fp4_block_scale_moe: No CSV output (kernel not available or all runs failed)
======================================================================
