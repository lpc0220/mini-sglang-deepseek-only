======================================================================
DeepSeek-R1-NVFP4-v2 Kernel Benchmarks
======================================================================
Kernels to run: 23
Batch sizes: 1,2,4,8,16,32,64,128
Sequence lengths: 128,256,512,1024,2048
Output directory: ../results/

NOTE: Each kernel runs in a separate subprocess for isolation.
      CUDA crashes in one kernel will NOT affect other kernels.
======================================================================

======================================================================
Running: rmsnorm (Norm, Memory)
======================================================================
============================================================
Benchmark: rmsnorm (Kernel #1)
============================================================

=== Decode Phase ===
  B=1: 0.0019 ms, 15.3 GB/s, 0.2% peak
  B=2: 0.0019 ms, 30.7 GB/s, 0.4% peak
  B=4: 0.0019 ms, 61.1 GB/s, 0.8% peak
  B=8: 0.0019 ms, 122.4 GB/s, 1.5% peak
  B=16: 0.0020 ms, 232.3 GB/s, 2.9% peak
  B=32: 0.0020 ms, 464.5 GB/s, 5.8% peak
  B=64: 0.0020 ms, 923.1 GB/s, 11.5% peak
  B=128: 0.0021 ms, 1775.8 GB/s, 22.2% peak

=== Prefill Phase ===
  B=1, S=128: 0.0021 ms, 1775.4 GB/s, 22.2% peak
  B=1, S=256: 0.0027 ms, 2758.3 GB/s, 34.5% peak
  B=1, S=512: 0.0046 ms, 3180.5 GB/s, 39.8% peak
  B=1, S=1024: 0.0081 ms, 3619.2 GB/s, 45.2% peak
  B=1, S=2048: 0.0150 ms, 3922.7 GB/s, 49.0% peak
  B=2, S=128: 0.0027 ms, 2760.3 GB/s, 34.5% peak
  B=2, S=256: 0.0046 ms, 3177.9 GB/s, 39.7% peak
  B=2, S=512: 0.0081 ms, 3618.9 GB/s, 45.2% peak
  B=2, S=1024: 0.0150 ms, 3916.9 GB/s, 49.0% peak
  B=2, S=2048: 0.0363 ms, 3231.5 GB/s, 40.4% peak
  B=4, S=128: 0.0046 ms, 3178.2 GB/s, 39.7% peak
  B=4, S=256: 0.0081 ms, 3614.4 GB/s, 45.2% peak
  B=4, S=512: 0.0150 ms, 3914.7 GB/s, 48.9% peak
  B=4, S=1024: 0.0364 ms, 3226.4 GB/s, 40.3% peak
  B=4, S=2048: 0.0702 ms, 3345.4 GB/s, 41.8% peak
  B=8, S=128: 0.0081 ms, 3612.8 GB/s, 45.2% peak
  B=8, S=256: 0.0150 ms, 3913.2 GB/s, 48.9% peak
  B=8, S=512: 0.0363 ms, 3235.9 GB/s, 40.4% peak
  B=8, S=1024: 0.0704 ms, 3337.2 GB/s, 41.7% peak
  B=8, S=2048: 0.1372 ms, 3423.8 GB/s, 42.8% peak
Saved ../results/rmsnorm.csv

[OK] rmsnorm completed successfully

======================================================================
Running: fused_add_rmsnorm (Norm, Memory)
======================================================================
============================================================
Benchmark: fused_add_rmsnorm (Kernel #2)
============================================================

=== Decode Phase ===
  B=1: 0.0023 ms, 24.7 GB/s, 0.3% peak
  B=2: 0.0023 ms, 49.2 GB/s, 0.6% peak
  B=4: 0.0023 ms, 99.1 GB/s, 1.2% peak
  B=8: 0.0023 ms, 196.6 GB/s, 2.5% peak
  B=16: 0.0024 ms, 382.5 GB/s, 4.8% peak
  B=32: 0.0024 ms, 760.1 GB/s, 9.5% peak
  B=64: 0.0024 ms, 1499.7 GB/s, 18.7% peak
  B=128: 0.0026 ms, 2871.7 GB/s, 35.9% peak

=== Prefill Phase ===
  B=1, S=128: 0.0026 ms, 2872.9 GB/s, 35.9% peak
  B=1, S=256: 0.0045 ms, 3276.3 GB/s, 41.0% peak
  B=1, S=512: 0.0081 ms, 3641.0 GB/s, 45.5% peak
  B=1, S=1024: 0.0143 ms, 4097.9 GB/s, 51.2% peak
  B=1, S=2048: 0.0272 ms, 4315.6 GB/s, 53.9% peak
  B=2, S=128: 0.0045 ms, 3278.0 GB/s, 41.0% peak
  B=2, S=256: 0.0081 ms, 3647.0 GB/s, 45.6% peak
  B=2, S=512: 0.0142 ms, 4133.2 GB/s, 51.7% peak
  B=2, S=1024: 0.0273 ms, 4300.4 GB/s, 53.8% peak
  B=2, S=2048: 0.0670 ms, 3508.2 GB/s, 43.9% peak
  B=4, S=128: 0.0081 ms, 3644.5 GB/s, 45.6% peak
  B=4, S=256: 0.0143 ms, 4107.6 GB/s, 51.3% peak
  B=4, S=512: 0.0272 ms, 4311.2 GB/s, 53.9% peak
  B=4, S=1024: 0.0675 ms, 3479.4 GB/s, 43.5% peak
  B=4, S=2048: 0.1310 ms, 3585.3 GB/s, 44.8% peak
  B=8, S=128: 0.0144 ms, 4088.8 GB/s, 51.1% peak
  B=8, S=256: 0.0274 ms, 4282.4 GB/s, 53.5% peak
  B=8, S=512: 0.0673 ms, 3488.2 GB/s, 43.6% peak
  B=8, S=1024: 0.1313 ms, 3577.6 GB/s, 44.7% peak
  B=8, S=2048: 0.2588 ms, 3630.8 GB/s, 45.4% peak
Saved ../results/fused_add_rmsnorm.csv

[OK] fused_add_rmsnorm completed successfully

======================================================================
Running: cutlass_scaled_fp4_mm (GEMM, Compute)
======================================================================
============================================================
Benchmark: cutlass_scaled_fp4_mm (Kernel #3)
============================================================

=== Decode Phase ===
  q_b_proj B=1: 0.0064 ms, 11852.1 GFLOPS, 0.13% peak
  kv_b_proj B=1: 0.0050 ms, 6646.8 GFLOPS, 0.07% peak
  o_proj B=1: 0.0233 ms, 10089.9 GFLOPS, 0.11% peak
  q_b_proj B=2: 0.0064 ms, 23718.9 GFLOPS, 0.26% peak
  kv_b_proj B=2: 0.0051 ms, 13231.0 GFLOPS, 0.15% peak
  o_proj B=2: 0.0233 ms, 20152.4 GFLOPS, 0.22% peak
  q_b_proj B=4: 0.0063 ms, 48055.5 GFLOPS, 0.53% peak
  kv_b_proj B=4: 0.0051 ms, 26533.6 GFLOPS, 0.29% peak
  o_proj B=4: 0.0232 ms, 40478.6 GFLOPS, 0.45% peak
  q_b_proj B=8: 0.0063 ms, 95788.4 GFLOPS, 1.06% peak
  kv_b_proj B=8: 0.0050 ms, 53287.4 GFLOPS, 0.59% peak
  o_proj B=8: 0.0232 ms, 80823.9 GFLOPS, 0.90% peak
  q_b_proj B=16: 0.0063 ms, 192132.2 GFLOPS, 2.13% peak
  kv_b_proj B=16: 0.0050 ms, 107917.7 GFLOPS, 1.20% peak
  o_proj B=16: 0.0233 ms, 161402.0 GFLOPS, 1.79% peak
  q_b_proj B=32: 0.0063 ms, 382830.5 GFLOPS, 4.25% peak
  kv_b_proj B=32: 0.0050 ms, 213984.2 GFLOPS, 2.38% peak
  o_proj B=32: 0.0234 ms, 321481.0 GFLOPS, 3.57% peak
  q_b_proj B=64: 0.0064 ms, 758762.4 GFLOPS, 8.43% peak
  kv_b_proj B=64: 0.0050 ms, 426968.3 GFLOPS, 4.74% peak
  o_proj B=64: 0.0235 ms, 639762.9 GFLOPS, 7.11% peak
  q_b_proj B=128: 0.0068 ms, 1424406.2 GFLOPS, 15.83% peak
  kv_b_proj B=128: 0.0054 ms, 793234.7 GFLOPS, 8.81% peak
  o_proj B=128: 0.0239 ms, 1257618.7 GFLOPS, 13.97% peak

=== Prefill Phase ===
  q_b_proj B=1, S=128: 0.0068 ms, 1419802.7 GFLOPS, 15.78% peak
  kv_b_proj B=1, S=128: 0.0054 ms, 793077.7 GFLOPS, 8.81% peak
  o_proj B=1, S=128: 0.0239 ms, 1257579.3 GFLOPS, 13.97% peak
  q_b_proj B=1, S=256: 0.0089 ms, 2175208.0 GFLOPS, 24.17% peak
  kv_b_proj B=1, S=256: 0.0070 ms, 1220603.6 GFLOPS, 13.56% peak
  o_proj B=1, S=256: 0.0220 ms, 2736463.3 GFLOPS, 30.41% peak
  q_b_proj B=1, S=512: 0.0123 ms, 3131761.3 GFLOPS, 34.80% peak
  kv_b_proj B=1, S=512: 0.0100 ms, 1712723.1 GFLOPS, 19.03% peak
  o_proj B=1, S=512: 0.0236 ms, 5088113.8 GFLOPS, 56.53% peak
  q_b_proj B=1, S=1024: 0.0199 ms, 3886793.3 GFLOPS, 43.19% peak
  kv_b_proj B=1, S=1024: 0.0151 ms, 2278816.0 GFLOPS, 25.32% peak
  o_proj B=1, S=1024: 0.0504 ms, 4769509.1 GFLOPS, 52.99% peak
  q_b_proj B=1, S=2048: 0.0401 ms, 3854173.1 GFLOPS, 42.82% peak
  kv_b_proj B=1, S=2048: 0.0285 ms, 2413700.0 GFLOPS, 26.82% peak
  o_proj B=1, S=2048: 0.0981 ms, 4905580.6 GFLOPS, 54.51% peak
  q_b_proj B=2, S=128: 0.0089 ms, 2170718.0 GFLOPS, 24.12% peak
  kv_b_proj B=2, S=128: 0.0070 ms, 1228590.3 GFLOPS, 13.65% peak
  o_proj B=2, S=128: 0.0220 ms, 2739014.5 GFLOPS, 30.43% peak
  q_b_proj B=2, S=256: 0.0123 ms, 3153416.9 GFLOPS, 35.04% peak
  kv_b_proj B=2, S=256: 0.0100 ms, 1715195.4 GFLOPS, 19.06% peak
  o_proj B=2, S=256: 0.0241 ms, 4989551.5 GFLOPS, 55.44% peak
  q_b_proj B=2, S=512: 0.0200 ms, 3868136.8 GFLOPS, 42.98% peak
  kv_b_proj B=2, S=512: 0.0151 ms, 2278753.2 GFLOPS, 25.32% peak
  o_proj B=2, S=512: 0.0498 ms, 4833221.1 GFLOPS, 53.70% peak
  q_b_proj B=2, S=1024: 0.0401 ms, 3852245.2 GFLOPS, 42.80% peak
  kv_b_proj B=2, S=1024: 0.0285 ms, 2414788.2 GFLOPS, 26.83% peak
  o_proj B=2, S=1024: 0.0974 ms, 4940786.7 GFLOPS, 54.90% peak
  q_b_proj B=2, S=2048: 0.0744 ms, 4158846.2 GFLOPS, 46.21% peak
  kv_b_proj B=2, S=2048: 0.0525 ms, 2619661.6 GFLOPS, 29.11% peak
  o_proj B=2, S=2048: 0.1870 ms, 5143723.8 GFLOPS, 57.15% peak
  q_b_proj B=4, S=128: 0.0123 ms, 3134890.7 GFLOPS, 34.83% peak
  kv_b_proj B=4, S=128: 0.0100 ms, 1712664.6 GFLOPS, 19.03% peak
  o_proj B=4, S=128: 0.0235 ms, 5126445.4 GFLOPS, 56.96% peak
  q_b_proj B=4, S=256: 0.0202 ms, 3819119.3 GFLOPS, 42.43% peak
  kv_b_proj B=4, S=256: 0.0153 ms, 2252962.9 GFLOPS, 25.03% peak
  o_proj B=4, S=256: 0.0499 ms, 4815614.5 GFLOPS, 53.51% peak
  q_b_proj B=4, S=512: 0.0402 ms, 3849688.7 GFLOPS, 42.77% peak
  kv_b_proj B=4, S=512: 0.0283 ms, 2431440.0 GFLOPS, 27.02% peak
  o_proj B=4, S=512: 0.0959 ms, 5013522.7 GFLOPS, 55.71% peak
  q_b_proj B=4, S=1024: 0.0749 ms, 4129465.3 GFLOPS, 45.88% peak
  kv_b_proj B=4, S=1024: 0.0545 ms, 2522392.7 GFLOPS, 28.03% peak
  o_proj B=4, S=1024: 0.1828 ms, 5264192.2 GFLOPS, 58.49% peak
  q_b_proj B=4, S=2048: 0.1472 ms, 4202961.0 GFLOPS, 46.70% peak
  kv_b_proj B=4, S=2048: 0.1033 ms, 2660386.8 GFLOPS, 29.56% peak
  o_proj B=4, S=2048: 0.3592 ms, 5356813.5 GFLOPS, 59.52% peak
  q_b_proj B=8, S=128: 0.0201 ms, 3851976.2 GFLOPS, 42.80% peak
  kv_b_proj B=8, S=128: 0.0152 ms, 2255901.2 GFLOPS, 25.07% peak
  o_proj B=8, S=128: 0.0500 ms, 4815134.7 GFLOPS, 53.50% peak
  q_b_proj B=8, S=256: 0.0403 ms, 3840397.5 GFLOPS, 42.67% peak
  kv_b_proj B=8, S=256: 0.0284 ms, 2418242.3 GFLOPS, 26.87% peak
  o_proj B=8, S=256: 0.0960 ms, 5011248.2 GFLOPS, 55.68% peak
  q_b_proj B=8, S=512: 0.0739 ms, 4184021.9 GFLOPS, 46.49% peak
  kv_b_proj B=8, S=512: 0.0523 ms, 2627477.2 GFLOPS, 29.19% peak
  o_proj B=8, S=512: 0.1853 ms, 5192581.8 GFLOPS, 57.70% peak
  q_b_proj B=8, S=1024: 0.1500 ms, 4122332.0 GFLOPS, 45.80% peak
  kv_b_proj B=8, S=1024: 0.1029 ms, 2671040.9 GFLOPS, 29.68% peak
  o_proj B=8, S=1024: 0.3657 ms, 5261797.1 GFLOPS, 58.46% peak
  q_b_proj B=8, S=2048: 0.2987 ms, 4141762.6 GFLOPS, 46.02% peak
  kv_b_proj B=8, S=2048: 0.2030 ms, 2707517.8 GFLOPS, 30.08% peak
  o_proj B=8, S=2048: 0.7204 ms, 5341898.0 GFLOPS, 59.35% peak
Saved ../results/cutlass_scaled_fp4_mm.csv

[OK] cutlass_scaled_fp4_mm completed successfully

======================================================================
Running: dsv3_fused_a_gemm (GEMM, Compute)
======================================================================
============================================================
Benchmark: dsv3_fused_a_gemm (Kernel #4)
============================================================

=== Decode Phase (B<=16, low-latency path) ===
  B=1: 0.0051 ms, 5923.4 GFLOPS, 0.26% peak
  B=2: 0.0051 ms, 11867.1 GFLOPS, 0.53% peak
  B=4: 0.0051 ms, 23661.4 GFLOPS, 1.05% peak
  B=8: 0.0052 ms, 46747.4 GFLOPS, 2.08% peak
  B=16: 0.0058 ms, 83782.6 GFLOPS, 3.72% peak
Saved ../results/dsv3_fused_a_gemm.csv

[OK] dsv3_fused_a_gemm completed successfully

======================================================================
Running: dsv3_router_gemm (GEMM, Compute)
======================================================================
============================================================
Benchmark: dsv3_router_gemm (Kernel #5)
============================================================

=== Decode Phase ===
  B=1: 0.0020 ms, 1846.3 GFLOPS, 0.08% peak
  B=2: 0.0022 ms, 3343.3 GFLOPS, 0.15% peak
  B=4: 0.0027 ms, 5388.9 GFLOPS, 0.24% peak
  B=8: 0.0036 ms, 8144.6 GFLOPS, 0.36% peak
  B=16: 0.0072 ms, 8165.2 GFLOPS, 0.36% peak
  Skipping B=32: kernel limited to num_tokens <= 16
  Skipping B=64: kernel limited to num_tokens <= 16
  Skipping B=128: kernel limited to num_tokens <= 16

=== Prefill Phase (skipped - kernel limited to 16 tokens) ===
Saved ../results/dsv3_router_gemm.csv

[OK] dsv3_router_gemm completed successfully

======================================================================
Running: bmm_fp8 (BMM, Compute)
======================================================================
============================================================
Benchmark: bmm_fp8 (Kernel #6)
============================================================

=== Decode Phase: q_nope * w_kc ===
  B=1: 0.0055 ms, 3034.9 GFLOPS, 0.07% peak
  B=2: 0.0055 ms, 6077.3 GFLOPS, 0.14% peak
  B=4: 0.0055 ms, 12154.8 GFLOPS, 0.27% peak
  B=8: 0.0055 ms, 24281.8 GFLOPS, 0.54% peak
  B=16: 0.0057 ms, 47435.3 GFLOPS, 1.05% peak
  B=32: 0.0058 ms, 92954.6 GFLOPS, 2.07% peak
  B=64: 0.0061 ms, 174806.0 GFLOPS, 3.88% peak
  B=128: 0.0070 ms, 307090.1 GFLOPS, 6.82% peak

=== Decode Phase: attn * w_vc ===
  B=1: 0.0028 ms, 6085.5 GFLOPS, 0.14% peak
  B=2: 0.0028 ms, 12154.5 GFLOPS, 0.27% peak
  B=4: 0.0028 ms, 24333.1 GFLOPS, 0.54% peak
  B=8: 0.0028 ms, 48504.0 GFLOPS, 1.08% peak
  B=16: 0.0031 ms, 85422.3 GFLOPS, 1.90% peak
  B=32: 0.0032 ms, 167701.9 GFLOPS, 3.73% peak
  B=64: 0.0034 ms, 318332.4 GFLOPS, 7.07% peak
  B=128: 0.0038 ms, 569943.0 GFLOPS, 12.67% peak
Saved ../results/bmm_fp8.csv

[OK] bmm_fp8 completed successfully

======================================================================
Running: cutlass_mla_decode (Attention, Mixed)
======================================================================
============================================================
Benchmark: cutlass_mla_decode (Kernel #7)
============================================================

=== Decode Phase (MLA Attention) ===
  B=1, seq_len=128: 0.0179 ms, 16.5 GB/s, memory
  B=1, seq_len=256: 0.0292 ms, 15.1 GB/s, memory
  B=1, seq_len=512: 0.0304 ms, 24.2 GB/s, memory
  B=1, seq_len=1024: 0.0299 ms, 44.4 GB/s, memory
  Skipping B=1, seq_len=2048: B*seq_len=2048 > 1024 (crash risk)
  B=2, seq_len=128: 0.0178 ms, 33.1 GB/s, memory
  B=2, seq_len=256: 0.0295 ms, 30.0 GB/s, memory
  B=2, seq_len=512: 0.0292 ms, 50.4 GB/s, memory
  Skipping B=2, seq_len=1024: B*seq_len=2048 > 1024 (crash risk)
  Skipping B=2, seq_len=2048: B*seq_len=4096 > 1024 (crash risk)
  B=4, seq_len=128: 0.0179 ms, 65.9 GB/s, memory
  B=4, seq_len=256: 0.0296 ms, 59.8 GB/s, memory
  Skipping B=4, seq_len=512: B*seq_len=2048 > 1024 (crash risk)
  Skipping B=4, seq_len=1024: B*seq_len=4096 > 1024 (crash risk)
  Skipping B=4, seq_len=2048: B*seq_len=8192 > 1024 (crash risk)
  B=8, seq_len=128: 0.0179 ms, 131.6 GB/s, memory
  Skipping B=8, seq_len=256: B*seq_len=2048 > 1024 (crash risk)
  Skipping B=8, seq_len=512: B*seq_len=4096 > 1024 (crash risk)
  Skipping B=8, seq_len=1024: B*seq_len=8192 > 1024 (crash risk)
  Skipping B=8, seq_len=2048: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=16, seq_len=128: B*seq_len=2048 > 1024 (crash risk)
  Skipping B=16, seq_len=256: B*seq_len=4096 > 1024 (crash risk)
  Skipping B=16, seq_len=512: B*seq_len=8192 > 1024 (crash risk)
  Skipping B=16, seq_len=1024: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=16, seq_len=2048: B*seq_len=32768 > 1024 (crash risk)
  Skipping B=32, seq_len=128: B*seq_len=4096 > 1024 (crash risk)
  Skipping B=32, seq_len=256: B*seq_len=8192 > 1024 (crash risk)
  Skipping B=32, seq_len=512: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=32, seq_len=1024: B*seq_len=32768 > 1024 (crash risk)
  Skipping B=32, seq_len=2048: B*seq_len=65536 > 1024 (crash risk)
  Skipping B=64, seq_len=128: B*seq_len=8192 > 1024 (crash risk)
  Skipping B=64, seq_len=256: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=64, seq_len=512: B*seq_len=32768 > 1024 (crash risk)
  Skipping B=64, seq_len=1024: B*seq_len=65536 > 1024 (crash risk)
  Skipping B=64, seq_len=2048: B*seq_len=131072 > 1024 (crash risk)
  Skipping B=128, seq_len=128: B*seq_len=16384 > 1024 (crash risk)
  Skipping B=128, seq_len=256: B*seq_len=32768 > 1024 (crash risk)
  Skipping B=128, seq_len=512: B*seq_len=65536 > 1024 (crash risk)
  Skipping B=128, seq_len=1024: B*seq_len=131072 > 1024 (crash risk)
  Skipping B=128, seq_len=2048: B*seq_len=262144 > 1024 (crash risk)
Saved ../results/cutlass_mla_decode.csv

[OK] cutlass_mla_decode completed successfully

======================================================================
Running: trtllm_batch_decode_with_kv_cache_mla (Attention, Mixed)
======================================================================
============================================================
Benchmark: trtllm_batch_decode_with_kv_cache_mla (Kernel #8)
============================================================

=== Decode Phase (TRT-LLM MLA Attention) ===
Warning: Kernel failed for B=1, seq_len=128: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=1, seq_len=256: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=1, seq_len=512: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=1, seq_len=1024: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=1, seq_len=2048: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=2, seq_len=128: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=2, seq_len=256: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=2, seq_len=512: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=2, seq_len=1024: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=2, seq_len=2048: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=4, seq_len=128: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=4, seq_len=256: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=4, seq_len=512: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=4, seq_len=1024: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=4, seq_len=2048: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=8, seq_len=128: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=8, seq_len=256: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=8, seq_len=512: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=8, seq_len=1024: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=8, seq_len=2048: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=16, seq_len=128: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=16, seq_len=256: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=16, seq_len=512: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=16, seq_len=1024: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=16, seq_len=2048: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=32, seq_len=128: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=32, seq_len=256: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=32, seq_len=512: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=32, seq_len=1024: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=32, seq_len=2048: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=64, seq_len=128: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=64, seq_len=256: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=64, seq_len=512: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=64, seq_len=1024: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=64, seq_len=2048: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=128, seq_len=128: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=128, seq_len=256: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=128, seq_len=512: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=128, seq_len=1024: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Warning: Kernel failed for B=128, seq_len=2048: trtllm_batch_decode_with_kv_cache_mla() missing 3 required positional arguments: 'block_tables', 'seq_lens', and 'max_seq_len'
Saved ../results/trtllm_batch_decode_with_kv_cache_mla.csv

[OK] trtllm_batch_decode_with_kv_cache_mla completed successfully

======================================================================
Running: trtllm_ragged_attention_deepseek (Attention, Mixed)
======================================================================
============================================================
Benchmark: trtllm_ragged_attention_deepseek (Kernel #9)
============================================================

=== Prefill Phase (TRT-LLM Ragged Attention) ===
Warning: Kernel failed for B=1, S=128: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=1, S=256: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=1, S=512: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=1, S=1024: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=1, S=2048: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=2, S=128: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=2, S=256: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=2, S=512: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=2, S=1024: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=2, S=2048: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=4, S=128: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=4, S=256: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=4, S=512: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=4, S=1024: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=4, S=2048: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=8, S=128: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=8, S=256: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=8, S=512: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=8, S=1024: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Warning: Kernel failed for B=8, S=2048: trtllm_ragged_attention_deepseek() missing 12 required positional arguments: 'max_q_len', 'max_kv_len', 'bmm1_scale', 'bmm2_scale', 'o_sf_scale', 'batch_size', 'window_left', 'cum_seq_lens_q', 'cum_seq_lens_kv', 'enable_pdl', 'is_causal', and 'return_lse'
Saved ../results/trtllm_ragged_attention_deepseek.csv

[OK] trtllm_ragged_attention_deepseek completed successfully

======================================================================
Running: mla_rope_quantize_fp8 (Attention, Memory)
======================================================================
============================================================
Benchmark: mla_rope_quantize_fp8 (Kernel #10)
============================================================

=== Decode Phase ===
Warning: Kernel failed for B=1, S=1: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=2, S=1: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=4, S=1: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=8, S=1: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=16, S=1: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=32, S=1: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=64, S=1: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=128, S=1: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'

=== Prefill Phase ===
Warning: Kernel failed for B=1, S=128: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=1, S=256: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=1, S=512: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=1, S=1024: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=1, S=2048: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=2, S=128: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=2, S=256: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=2, S=512: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=2, S=1024: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=2, S=2048: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=4, S=128: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=4, S=256: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=4, S=512: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=4, S=1024: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=4, S=2048: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=8, S=128: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=8, S=256: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=8, S=512: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=8, S=1024: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Warning: Kernel failed for B=8, S=2048: mla_rope_quantize_fp8() missing 1 required positional argument: 'pos_ids'
Saved ../results/mla_rope_quantize_fp8.csv

[OK] mla_rope_quantize_fp8 completed successfully

======================================================================
Running: apply_rope_with_cos_sin_cache_inplace (RoPE, Memory)
======================================================================
============================================================
Benchmark: apply_rope_with_cos_sin_cache_inplace (Kernel #11)
============================================================

=== Decode Phase ===
Warning: Kernel failed for B=1, S=1: cos_sin_cache should be float32
Warning: Kernel failed for B=2, S=1: cos_sin_cache should be float32
Warning: Kernel failed for B=4, S=1: cos_sin_cache should be float32
Warning: Kernel failed for B=8, S=1: cos_sin_cache should be float32
Warning: Kernel failed for B=16, S=1: cos_sin_cache should be float32
Warning: Kernel failed for B=32, S=1: cos_sin_cache should be float32
Warning: Kernel failed for B=64, S=1: cos_sin_cache should be float32
Warning: Kernel failed for B=128, S=1: cos_sin_cache should be float32

=== Prefill Phase ===
Warning: Kernel failed for B=1, S=128: cos_sin_cache should be float32
Warning: Kernel failed for B=1, S=256: cos_sin_cache should be float32
Warning: Kernel failed for B=1, S=512: cos_sin_cache should be float32
Warning: Kernel failed for B=1, S=1024: cos_sin_cache should be float32
Warning: Kernel failed for B=1, S=2048: cos_sin_cache should be float32
Warning: Kernel failed for B=2, S=128: cos_sin_cache should be float32
Warning: Kernel failed for B=2, S=256: cos_sin_cache should be float32
Warning: Kernel failed for B=2, S=512: cos_sin_cache should be float32
Warning: Kernel failed for B=2, S=1024: cos_sin_cache should be float32
Warning: Kernel failed for B=2, S=2048: cos_sin_cache should be float32
Warning: Kernel failed for B=4, S=128: cos_sin_cache should be float32
Warning: Kernel failed for B=4, S=256: cos_sin_cache should be float32
Warning: Kernel failed for B=4, S=512: cos_sin_cache should be float32
Warning: Kernel failed for B=4, S=1024: cos_sin_cache should be float32
Warning: Kernel failed for B=4, S=2048: cos_sin_cache should be float32
Warning: Kernel failed for B=8, S=128: cos_sin_cache should be float32
Warning: Kernel failed for B=8, S=256: cos_sin_cache should be float32
Warning: Kernel failed for B=8, S=512: cos_sin_cache should be float32
Warning: Kernel failed for B=8, S=1024: cos_sin_cache should be float32
Warning: Kernel failed for B=8, S=2048: cos_sin_cache should be float32
Saved ../results/apply_rope_with_cos_sin_cache_inplace.csv

[OK] apply_rope_with_cos_sin_cache_inplace completed successfully

======================================================================
Running: concat_mla_k (Concat, Memory)
======================================================================
============================================================
Benchmark: concat_mla_k (Kernel #12)
============================================================

=== Decode Phase ===
  B=1: 0.0021 ms, 39.5 GB/s, 0.5% peak
  B=2: 0.0029 ms, 55.8 GB/s, 0.7% peak
  B=4: 0.0048 ms, 69.0 GB/s, 0.9% peak
  B=8: 0.0048 ms, 136.9 GB/s, 1.7% peak
  B=16: 0.0048 ms, 274.0 GB/s, 3.4% peak
  B=32: 0.0048 ms, 551.4 GB/s, 6.9% peak
  B=64: 0.0049 ms, 1074.3 GB/s, 13.4% peak
  B=128: 0.0049 ms, 2143.7 GB/s, 26.8% peak

=== Prefill Phase ===
  B=1, S=128: 0.0049 ms, 2143.1 GB/s, 26.8% peak
  B=1, S=256: 0.0050 ms, 4226.4 GB/s, 52.8% peak
  B=1, S=512: 0.0054 ms, 7843.2 GB/s, 98.0% peak
  B=1, S=1024: 0.0106 ms, 7892.5 GB/s, 98.7% peak
  B=1, S=2048: 0.0274 ms, 6135.0 GB/s, 76.7% peak
  B=2, S=128: 0.0050 ms, 4242.7 GB/s, 53.0% peak
  B=2, S=256: 0.0051 ms, 8235.8 GB/s, 102.9% peak
  B=2, S=512: 0.0095 ms, 8859.0 GB/s, 110.7% peak
  B=2, S=1024: 0.0275 ms, 6115.1 GB/s, 76.4% peak
  B=2, S=2048: 0.0519 ms, 6474.3 GB/s, 80.9% peak
  B=4, S=128: 0.0051 ms, 8201.9 GB/s, 102.5% peak
  B=4, S=256: 0.0095 ms, 8863.0 GB/s, 110.8% peak
  B=4, S=512: 0.0273 ms, 6160.6 GB/s, 77.0% peak
  B=4, S=1024: 0.0520 ms, 6458.3 GB/s, 80.7% peak
  B=4, S=2048: 0.1010 ms, 6653.5 GB/s, 83.2% peak
  B=8, S=128: 0.0095 ms, 8864.9 GB/s, 110.8% peak
  B=8, S=256: 0.0275 ms, 6106.6 GB/s, 76.3% peak
  B=8, S=512: 0.0524 ms, 6408.5 GB/s, 80.1% peak
  B=8, S=1024: 0.1011 ms, 6649.3 GB/s, 83.1% peak
  B=8, S=2048: 0.1983 ms, 6780.3 GB/s, 84.8% peak
Saved ../results/concat_mla_k.csv

[OK] concat_mla_k completed successfully

======================================================================
Running: silu_and_mul (Activation, Memory)
======================================================================
============================================================
Benchmark: silu_and_mul (Kernel #13)
============================================================

=== Decode Phase ===
  B=1: 0.0018 ms, 6.9 GB/s, 0.1% peak
  B=2: 0.0018 ms, 13.8 GB/s, 0.2% peak
  B=4: 0.0018 ms, 27.8 GB/s, 0.3% peak
  B=8: 0.0018 ms, 55.4 GB/s, 0.7% peak
  B=16: 0.0019 ms, 105.0 GB/s, 1.3% peak
  B=32: 0.0019 ms, 209.5 GB/s, 2.6% peak
  B=64: 0.0019 ms, 413.6 GB/s, 5.2% peak
  B=128: 0.0019 ms, 812.6 GB/s, 10.2% peak

=== Prefill Phase ===
  B=1, S=128: 0.0019 ms, 812.6 GB/s, 10.2% peak
  B=1, S=256: 0.0021 ms, 1477.2 GB/s, 18.5% peak
  B=1, S=512: 0.0028 ms, 2244.0 GB/s, 28.1% peak
  B=1, S=1024: 0.0038 ms, 3292.7 GB/s, 41.2% peak
  B=1, S=2048: 0.0058 ms, 4368.7 GB/s, 54.6% peak
  B=2, S=128: 0.0021 ms, 1472.1 GB/s, 18.4% peak
  B=2, S=256: 0.0028 ms, 2248.2 GB/s, 28.1% peak
  B=2, S=512: 0.0038 ms, 3295.3 GB/s, 41.2% peak
  B=2, S=1024: 0.0058 ms, 4369.2 GB/s, 54.6% peak
  B=2, S=2048: 0.0098 ms, 5128.0 GB/s, 64.1% peak
  B=4, S=128: 0.0028 ms, 2242.7 GB/s, 28.0% peak
  B=4, S=256: 0.0038 ms, 3297.2 GB/s, 41.2% peak
  B=4, S=512: 0.0058 ms, 4368.1 GB/s, 54.6% peak
  B=4, S=1024: 0.0098 ms, 5117.2 GB/s, 64.0% peak
  B=4, S=2048: 0.0199 ms, 5060.4 GB/s, 63.3% peak
  B=8, S=128: 0.0038 ms, 3287.1 GB/s, 41.1% peak
  B=8, S=256: 0.0058 ms, 4368.5 GB/s, 54.6% peak
  B=8, S=512: 0.0098 ms, 5114.3 GB/s, 63.9% peak
  B=8, S=1024: 0.0197 ms, 5110.2 GB/s, 63.9% peak
  B=8, S=2048: 0.0400 ms, 5032.3 GB/s, 62.9% peak
Saved ../results/silu_and_mul.csv

[OK] silu_and_mul completed successfully

======================================================================
Running: topk_softmax (MoE Routing, Memory)
======================================================================
============================================================
Benchmark: topk_softmax (Kernel #14)
============================================================

=== Decode Phase ===
Warning: Kernel failed for B=1, S=1: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=2, S=1: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=4, S=1: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=8, S=1: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=16, S=1: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=32, S=1: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=64, S=1: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=128, S=1: topk_softmax() missing 1 required positional argument: 'gating_output'

=== Prefill Phase ===
Warning: Kernel failed for B=1, S=128: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=1, S=256: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=1, S=512: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=1, S=1024: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=1, S=2048: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=2, S=128: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=2, S=256: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=2, S=512: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=2, S=1024: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=2, S=2048: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=4, S=128: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=4, S=256: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=4, S=512: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=4, S=1024: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=4, S=2048: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=8, S=128: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=8, S=256: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=8, S=512: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=8, S=1024: topk_softmax() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=8, S=2048: topk_softmax() missing 1 required positional argument: 'gating_output'
Saved ../results/topk_softmax.csv

[OK] topk_softmax completed successfully

======================================================================
Running: topk_sigmoid (MoE Routing, Memory)
======================================================================
============================================================
Benchmark: topk_sigmoid (Kernel #15)
============================================================

=== Decode Phase ===
Warning: Kernel failed for B=1, S=1: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=2, S=1: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=4, S=1: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=8, S=1: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=16, S=1: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=32, S=1: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=64, S=1: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=128, S=1: topk_sigmoid() missing 1 required positional argument: 'gating_output'

=== Prefill Phase ===
Warning: Kernel failed for B=1, S=128: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=1, S=256: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=1, S=512: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=1, S=1024: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=1, S=2048: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=2, S=128: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=2, S=256: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=2, S=512: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=2, S=1024: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=2, S=2048: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=4, S=128: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=4, S=256: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=4, S=512: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=4, S=1024: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=4, S=2048: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=8, S=128: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=8, S=256: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=8, S=512: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=8, S=1024: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Warning: Kernel failed for B=8, S=2048: topk_sigmoid() missing 1 required positional argument: 'gating_output'
Saved ../results/topk_sigmoid.csv

[OK] topk_sigmoid completed successfully

======================================================================
Running: moe_fused_gate (MoE Routing, Memory)
======================================================================
============================================================
Benchmark: moe_fused_gate (Kernel #16)
============================================================

=== Decode Phase ===
Warning: Kernel failed for B=1, S=1: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=2, S=1: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=4, S=1: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=8, S=1: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=16, S=1: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=32, S=1: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=64, S=1: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=128, S=1: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'

=== Prefill Phase ===
Warning: Kernel failed for B=1, S=128: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=1, S=256: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=1, S=512: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=1, S=1024: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=1, S=2048: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=2, S=128: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=2, S=256: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=2, S=512: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=2, S=1024: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=2, S=2048: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=4, S=128: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=4, S=256: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=4, S=512: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=4, S=1024: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=4, S=2048: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=8, S=128: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=8, S=256: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=8, S=512: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=8, S=1024: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Warning: Kernel failed for B=8, S=2048: moe_fused_gate() missing 2 required positional arguments: 'topk_group' and 'topk'
Saved ../results/moe_fused_gate.csv

[OK] moe_fused_gate completed successfully

======================================================================
Running: prepare_moe_input (MoE, Memory)
======================================================================
============================================================
Benchmark: prepare_moe_input (Kernel #17)
============================================================

=== Decode Phase ===
Warning: Kernel failed for B=1, S=1: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=2, S=1: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=4, S=1: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=8, S=1: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=16, S=1: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=32, S=1: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=64, S=1: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=128, S=1: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'

=== Prefill Phase ===
Warning: Kernel failed for B=1, S=128: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=1, S=256: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=1, S=512: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=1, S=1024: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=1, S=2048: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=2, S=128: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=2, S=256: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=2, S=512: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=2, S=1024: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=2, S=2048: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=4, S=128: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=4, S=256: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=4, S=512: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=4, S=1024: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=4, S=2048: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=8, S=128: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=8, S=256: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=8, S=512: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=8, S=1024: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'
Warning: Kernel failed for B=8, S=2048: prepare_moe_input() missing 6 required positional arguments: 'problem_sizes2', 'input_permutation', 'output_permutation', 'num_experts', 'n', and 'k'

No results - kernel not available

[OK] prepare_moe_input completed successfully

======================================================================
Running: scaled_fp4_experts_quant (MoE, Memory)
======================================================================
============================================================
Benchmark: scaled_fp4_experts_quant (Kernel #18)
============================================================

=== Decode Phase ===
Warning: Kernel failed for B=1, S=1: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=2, S=1: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=4, S=1: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=8, S=1: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=16, S=1: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=32, S=1: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=64, S=1: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=128, S=1: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'

=== Prefill Phase ===
Warning: Kernel failed for B=1, S=128: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=1, S=256: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=1, S=512: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=1, S=1024: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=1, S=2048: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=2, S=128: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=2, S=256: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=2, S=512: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=2, S=1024: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=2, S=2048: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=4, S=128: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=4, S=256: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=4, S=512: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=4, S=1024: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=4, S=2048: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=8, S=128: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=8, S=256: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=8, S=512: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=8, S=1024: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'
Warning: Kernel failed for B=8, S=2048: scaled_fp4_experts_quant() missing 4 required positional arguments: 'input_global_scale', 'expert_offsets', 'blockscale_offsets', and 'topk'

No results - kernel not available

[OK] scaled_fp4_experts_quant completed successfully

======================================================================
Running: cutlass_fp4_group_mm (MoE, Compute)
======================================================================
============================================================
Benchmark: cutlass_fp4_group_mm (Kernel #19)
============================================================

=== Decode Phase: gate_up ===
Warning: Kernel failed for B=1, S=1, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=2, S=1, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=4, S=1, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=8, S=1, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=16, S=1, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=32, S=1, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=64, S=1, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=128, S=1, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'

=== Decode Phase: down ===
Warning: Kernel failed for B=1, S=1, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=2, S=1, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=4, S=1, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=8, S=1, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=16, S=1, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=32, S=1, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=64, S=1, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=128, S=1, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'

=== Prefill Phase: gate_up ===
Warning: Kernel failed for B=1, S=128, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=1, S=256, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=1, S=512, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=1, S=1024, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=1, S=2048, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=2, S=128, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=2, S=256, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=2, S=512, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=2, S=1024, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=2, S=2048, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=4, S=128, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=4, S=256, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=4, S=512, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=4, S=1024, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=4, S=2048, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=8, S=128, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=8, S=256, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=8, S=512, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=8, S=1024, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=8, S=2048, op=gate_up: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'

=== Prefill Phase: down ===
Warning: Kernel failed for B=1, S=128, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=1, S=256, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=1, S=512, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=1, S=1024, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=1, S=2048, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=2, S=128, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=2, S=256, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=2, S=512, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=2, S=1024, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=2, S=2048, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=4, S=128, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=4, S=256, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=4, S=512, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=4, S=1024, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=4, S=2048, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=8, S=128, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=8, S=256, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=8, S=512, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=8, S=1024, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'
Warning: Kernel failed for B=8, S=2048, op=down: cutlass_fp4_group_mm() missing 1 required positional argument: 'params'

No results - kernel not available

[OK] cutlass_fp4_group_mm completed successfully

======================================================================
Running: apply_shuffle_mul_sum (MoE, Memory)
======================================================================
============================================================
Benchmark: apply_shuffle_mul_sum (Kernel #20)
============================================================

=== Decode Phase ===
Warning: Kernel failed for B=1, S=1: Factors must match output dtype
Warning: Kernel failed for B=2, S=1: Factors must match output dtype
Warning: Kernel failed for B=4, S=1: Factors must match output dtype
Warning: Kernel failed for B=8, S=1: Factors must match output dtype
Warning: Kernel failed for B=16, S=1: Factors must match output dtype
Warning: Kernel failed for B=32, S=1: Factors must match output dtype
Warning: Kernel failed for B=64, S=1: Factors must match output dtype
Warning: Kernel failed for B=128, S=1: Factors must match output dtype

=== Prefill Phase ===
Warning: Kernel failed for B=1, S=128: Factors must match output dtype
Warning: Kernel failed for B=1, S=256: Factors must match output dtype
Warning: Kernel failed for B=1, S=512: Factors must match output dtype
Warning: Kernel failed for B=1, S=1024: Factors must match output dtype
Warning: Kernel failed for B=1, S=2048: Factors must match output dtype
Warning: Kernel failed for B=2, S=128: Factors must match output dtype
Warning: Kernel failed for B=2, S=256: Factors must match output dtype
Warning: Kernel failed for B=2, S=512: Factors must match output dtype
Warning: Kernel failed for B=2, S=1024: Factors must match output dtype
Warning: Kernel failed for B=2, S=2048: Factors must match output dtype
Warning: Kernel failed for B=4, S=128: Factors must match output dtype
Warning: Kernel failed for B=4, S=256: Factors must match output dtype
Warning: Kernel failed for B=4, S=512: Factors must match output dtype
Warning: Kernel failed for B=4, S=1024: Factors must match output dtype
Warning: Kernel failed for B=4, S=2048: Factors must match output dtype
Warning: Kernel failed for B=8, S=128: Factors must match output dtype
Warning: Kernel failed for B=8, S=256: Factors must match output dtype
Warning: Kernel failed for B=8, S=512: Factors must match output dtype
Warning: Kernel failed for B=8, S=1024: Factors must match output dtype
Warning: Kernel failed for B=8, S=2048: Factors must match output dtype

No results - kernel not available

[OK] apply_shuffle_mul_sum completed successfully

======================================================================
Running: moe_align_block_size (MoE, Memory)
======================================================================
============================================================
Benchmark: moe_align_block_size (Kernel #21)
============================================================

=== Decode Phase ===
Warning: Kernel failed for B=1, S=1: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=2, S=1: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=4, S=1: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=8, S=1: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=16, S=1: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=32, S=1: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=64, S=1: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=128, S=1: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'

=== Prefill Phase ===
Warning: Kernel failed for B=1, S=128: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=1, S=256: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=1, S=512: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=1, S=1024: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=1, S=2048: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=2, S=128: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=2, S=256: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=2, S=512: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=2, S=1024: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=2, S=2048: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=4, S=128: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=4, S=256: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=4, S=512: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=4, S=1024: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=4, S=2048: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=8, S=128: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=8, S=256: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=8, S=512: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=8, S=1024: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'
Warning: Kernel failed for B=8, S=2048: moe_align_block_size() missing 4 required positional arguments: 'sorted_token_ids', 'experts_ids', 'num_tokens_post_pad', and 'cumsum_buffer'

No results - kernel not available

[OK] moe_align_block_size completed successfully

======================================================================
Running: trtllm_fp4_block_scale_moe (MoE, Mixed)
======================================================================
============================================================
Benchmark: trtllm_fp4_block_scale_moe (Kernel #22)
============================================================

=== Decode Phase ===
Warning: Kernel failed for B=1, S=1: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=2, S=1: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=4, S=1: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=8, S=1: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=16, S=1: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=32, S=1: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=64, S=1: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=128, S=1: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'

=== Prefill Phase ===
Warning: Kernel failed for B=1, S=128: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=1, S=256: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=1, S=512: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=1, S=1024: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=1, S=2048: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=2, S=128: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=2, S=256: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=2, S=512: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=2, S=1024: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=2, S=2048: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=4, S=128: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=4, S=256: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=4, S=512: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=4, S=1024: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=4, S=2048: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=8, S=128: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=8, S=256: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=8, S=512: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=8, S=1024: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'
Warning: Kernel failed for B=8, S=2048: trtllm_fp4_block_scale_moe() missing 19 required positional arguments: 'gemm1_weights_scale', 'gemm1_bias', 'gemm1_alpha', 'gemm1_beta', 'gemm1_clamp_limit', 'gemm2_weights', 'gemm2_weights_scale', 'gemm2_bias', 'output1_scale_scalar', 'output1_scale_gate_scalar', 'output2_scale_scalar', 'num_experts', 'top_k', 'n_group', 'topk_group', 'intermediate_size', 'local_expert_offset', 'local_num_experts', and 'routed_scaling_factor'

No results - kernel not available

[OK] trtllm_fp4_block_scale_moe completed successfully

======================================================================
Running: fused_moe_kernel (MoE, Mixed)
======================================================================
============================================================
Benchmark: fused_moe_kernel (Kernel #23)
============================================================

=== Decode Phase ===
Warning: Kernel failed for B=1, S=1: 'module' object is not callable
Warning: Kernel failed for B=2, S=1: 'module' object is not callable
Warning: Kernel failed for B=4, S=1: 'module' object is not callable
Warning: Kernel failed for B=8, S=1: 'module' object is not callable
Warning: Kernel failed for B=16, S=1: 'module' object is not callable
Warning: Kernel failed for B=32, S=1: 'module' object is not callable
Warning: Kernel failed for B=64, S=1: 'module' object is not callable
Warning: Kernel failed for B=128, S=1: 'module' object is not callable

=== Prefill Phase ===
Warning: Kernel failed for B=1, S=128: 'module' object is not callable
Warning: Kernel failed for B=1, S=256: 'module' object is not callable
Warning: Kernel failed for B=1, S=512: 'module' object is not callable
Warning: Kernel failed for B=1, S=1024: 'module' object is not callable
Warning: Kernel failed for B=1, S=2048: 'module' object is not callable
Warning: Kernel failed for B=2, S=128: 'module' object is not callable
Warning: Kernel failed for B=2, S=256: 'module' object is not callable
Warning: Kernel failed for B=2, S=512: 'module' object is not callable
Warning: Kernel failed for B=2, S=1024: 'module' object is not callable
Warning: Kernel failed for B=2, S=2048: 'module' object is not callable
Warning: Kernel failed for B=4, S=128: 'module' object is not callable
Warning: Kernel failed for B=4, S=256: 'module' object is not callable
Warning: Kernel failed for B=4, S=512: 'module' object is not callable
Warning: Kernel failed for B=4, S=1024: 'module' object is not callable
Warning: Kernel failed for B=4, S=2048: 'module' object is not callable
Warning: Kernel failed for B=8, S=128: 'module' object is not callable
Warning: Kernel failed for B=8, S=256: 'module' object is not callable
Warning: Kernel failed for B=8, S=512: 'module' object is not callable
Warning: Kernel failed for B=8, S=1024: 'module' object is not callable
Warning: Kernel failed for B=8, S=2048: 'module' object is not callable

No results - kernel not available

[OK] fused_moe_kernel completed successfully

Aggregated results saved to ../results/all_kernels.csv
Total benchmark results: 232

Summary saved to ../results/benchmark_summary.md

======================================================================
Benchmark Complete!
Successful: 23/23
======================================================================
